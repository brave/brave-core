// Copyright (c) 2024 The Brave Authors. All rights reserved.
// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this file,
// You can obtain one at https://mozilla.org/MPL/2.0/.

#include "brave/components/brave_wallet/browser/internal/orchard_bundle_manager.h"

#include <array>
#include <utility>
#include <vector>

#include "brave/components/brave_wallet/common/buildflags.h"
#include "brave/components/brave_wallet/common/hex_utils.h"
#include "brave/components/brave_wallet/common/zcash_utils.h"
#include "testing/gtest/include/gtest/gtest.h"

static_assert(BUILDFLAG(ENABLE_ORCHARD));

namespace brave_wallet {

namespace {
void AppendMerklePath(OrchardNoteWitness& witness, const std::string& hex) {
  OrchardMerkleHash hash;
  base::span(hash).copy_from(*PrefixedHexStringToBytes(hex));
  witness.merkle_path.push_back(hash);
}
}  // namespace

TEST(OrchardBundleManagerTest, SingleOutput) {
  OrchardBundleManager::OverrideRandomSeedForTesting(0);

  std::vector<OrchardOutput> outputs;
  outputs.push_back(OrchardOutput{
      100000,
      {212, 113, 78,  231, 97,  209, 174, 130, 59,  105, 114, 21,  46,  32, 149,
       127, 239, 163, 246, 227, 18,  158, 164, 223, 176, 169, 233, 135, 3,  166,
       61,  171, 146, 149, 137, 214, 220, 81,  201, 112, 249, 53,  179}});

  OrchardSpendsBundle orchard_spends_bundle;
  auto unauthorized_state = OrchardBundleManager::Create(
      std::vector<uint8_t>(), orchard_spends_bundle, std::move(outputs));
  EXPECT_TRUE(unauthorized_state);
  // Unauthorized state doesn't have raw tx bytes
  EXPECT_FALSE(unauthorized_state->GetRawTxBytes());
  EXPECT_EQ(
      "0x5af5dcc1436a1746e8a702a1d7763e8c7b2857f0037c2bcf3b02bea8c36fe6d5",
      ToHex(unauthorized_state->GetOrchardDigest().value()));

  auto authorized_state =
      unauthorized_state->ApplySignature(std::array<uint8_t, 32>());
  // Digest is provided only in unauthorized state
  EXPECT_FALSE(authorized_state->GetOrchardDigest().has_value());

  // Can't apply signature second time
  EXPECT_FALSE(authorized_state->ApplySignature(std::array<uint8_t, 32>()));

  EXPECT_EQ(
      "0x024330112c31d0cbb0db4f77cefc9036ed215ea86ba2aee9a5de08953a8216282f5136"
      "e6"
      "2a35a7a471c0a68f7a2b09915993244010af0ce69e863a0cdc68042b103dd62d315080c0"
      "bec"
      "76397d7c6ad365d84a6354d07049e484d0240410c589389eeb33ccbb564cc383b01383d4"
      "bac"
      "03648d6f155fc5d3d280f0f85a3687f17b0e90a1dc6793503417e53794980e4b8b5e1a18"
      "e454"
      "da912fa17818988a7b0b1006fedd657b795cc584843cb90f9cdf67912f2017dccdb38584"
      "39db"
      "ea6fadbeeabf0ac892bc6f2c59cc9344d9f1b781671ae7c9df2f4f69fce6c8215fa7feae"
      "4be"
      "87a0b5bb08266bead9d4ee0f80433cd17b713643a5f02ce53392cb015418fc4ff336ea32"
      "d7a749448802b7f828d51d51d78e707d268959c856d9239a6eff5090d1813581a19c24df"
      "421a03eea8bd7e9f8a9cf938c35fe65cf213a1a4b6c727e9401cc519f3ef3f2c93607914"
      "9bc2af3083d8a963811c761138e44383c08c34de0d483f62879c4cb80c5cb84124da36ab"
      "e113d68eadd017c5c268d6fbdd9c661753fe5375c8043fa3e9f9c94a8e1035bdd2e8eaa3"
      "a814d0a62657bc5fe689568b5a41ab718342b4790520e1bceb54b987d2590354b54fe695"
      "ca24c6585bb591cdc2ac395f06a07194812aeceaac0cdbc4178b68be11e30352956b2503"
      "78495bfaa4b326d264db71b83b28ef164300dee9a17f187617596c071f63d9383aeecec6"
      "f28e1080013e674b2412d15dd667e2532339caed06f4db6da25e7fcc326a1a58469d94df"
      "082166dbb24a1117898bf7c497466690d13949cd1db05a516622cb2d746469d04e716ace"
      "bb04f1c519f00d26dac539a71c2e4c9f1efa0cec80ba0cf37a29cd375e0fa70146becfc6"
      "6ef4cace008fc8a22ae77aa718ce5a149256df6407a24d33e5eb1e9d51b2bd2ba4d71b71"
      "f3bb54538e984f719bbb2daebec2a54476a4104daa47d591fd9db9820f68d48cf52dee3f"
      "8772fdd25de4ae436ea1cf125296c30e91262b407c80188224c356572acdcca3f41fcefb"
      "5e618993b1214a542a06425439ac7c8812be6a0bb8ccd9abedd75202451ca522cff1643f"
      "da3e399bf60b2b7393a6f89dd8dca6a1c1ede5965975a62c0088d3a5e68c0b635535c053"
      "509c7f55bf9261ecf9b5c2ca045762df3966fe4c1e97af1c6e3a1ec3eb3f9b57bfdf4406"
      "9a9d45105bc00a04f80f9e15f02b34aa42ca95ec8527ea52d52ce05750a1d67216a3b2f3"
      "34682f65ce5ea49599bd7e01f98d14c07095635740c3bf644a7d5eb61c16d28a5bdfdfac"
      "b311a29f6b62fe50b71864f70937ba483b96ab0c4f6c566ddd1bb55536a33a20a8b4f964"
      "2f67e8e16662017b947df57320a51cd1141d8e46a40a8c9de24b30c0b08957050b693dc1"
      "8c5acc1482e07204cf113ac974dde5d62044ad29910f5a59256ad08352c7141f6b65043a"
      "86e93a3a25fdba8f6f72b60a9e5276da3e20f4e36573ed72aedcb4ae68ac15a576671933"
      "c1a102d172031fb0d586b1ffb70828ff5a3ff02b38d67153388bfcf5b6d02bb476225fc5"
      "0786083d09fad59b0b97da176b7b4787277d4f90e090b8e6f370b38eada32da32734553d"
      "64b4681c21af7ffe2bcb8d914e43cf24a953a0f94edd975409bf5927de38e324ea2e52bf"
      "4590b0391dff3ded4354d0bfe2ae3acb4a9302124c73718ca2d2a30667be950fad78bb9f"
      "e49f8ffa40afb40a2ab26ecd17bc9ed16dc0e848550825fd093c6f1c4eafcb1c7c985960"
      "2f7fede5fbe5becf84f28bf74abc880e56b77ed7a7242448da180f07ffe854a7fa321a27"
      "22cdb9c1c46b93186ad15001b32c0a7de4a02a1526b334d97c2b36f6d0fe83d3f219837c"
      "2adc186d6ef1a3f1e0a50d6ca2fc1c2c2a2ea95373d6a2fd9906f49296f3e8bc141a8c6b"
      "bc904722c2541756622d7284e45697c6f0f1a141b786e80fe882391d7c5919bb98e2fa17"
      "19da21c9e4d04a0c30888b0b608d46a054c32b75bee0396efdeb310e8c5211d41728ab79"
      "6a44cdb543468e0d655cf64afd62e71dd4688eb7e2e196025f1ef0c2cbc99cc08075cb36"
      "b99cca1600edd3f6451eedff9c3adeb7b843deb83a5582e51ad32881b8ca6064986a41d2"
      "6d91d0c48adef928d766c7f58bd9a31da0096c7bf18a9f8c307f14bc82ae3601b8240706"
      "9e4dd8a2c4b72909e2810435816ed3747e85302c90381e0dee2232d6c21b55310b76fbda"
      "ba0aa2deb8a1c25641604b1bf523281c8f7c5a80a93d967ced9978830b45c2dbf64d9ca8"
      "cdc6498082ae003d50eafee3c930d40d253f4bfe65ec69e7260d3b99dbed28acab956ba7"
      "9ff0107d586c878760caa9ac9036079feffffffffffae2935f1dfd8a24aed7c70df7de3a"
      "668eb7a49b1319880dde2bbd9031ae5d82ffd601c6d8bb1d603470a10040bb5033349893"
      "3da7cac03eb16937cef9d35d9371046b2d13387711416e9c51d066f32fdfae7203369a14"
      "49da2700c37bfdb099d24a2be7f8abd0833762284617c9150b81e04d4051e0aaccc71001"
      "79b997b8fa7bfdd305d4183f78f8385336c189426bf0ff42bb5c766a93d2ebb4f3fe8983"
      "5da45c106c9dc861332d6f3b6705239303cd9b60210a9a266532934511322f6ba8eac228"
      "a2df4ddddd778bad54694afc2f7d4159a3363361c4b677d723a7fb56a6f0f2914e7710b0"
      "ba8b8d1c209db43bb4911677f1bc1f7fa3faf5d4498753761c08b5129fe69223b94ebb00"
      "548ab19310d28c02a3930c68b0cdfa548106476c7d98b46b56e441701fa115d58c76a523"
      "ee2711d13b2b75e45ac466ed3ca501b690d89a92047c72cfe3dbbddd9ba784458ac8520e"
      "369993b31535f3585b7e0679a5dabbcac553e904db5b8f5884679ff1fd49ff4cb9f57ee3"
      "fba42e5dfce4de71f26f11c94da728f9d159ce803c145fd1fa3070d6c6d4318d303d0503"
      "34374a84eaf66ba2f9672239e32ad301a542d3d569c94d23a9a9b424069c4a66261fee5f"
      "f3c66282f6ed9e89898f5ca0c0b26ff37f21633bf35cacfc848fc192a7be3641eeadd1d3"
      "4641912dd53e4400391bc5341ff004f14dbd35fe96960f86062dfc49092178ab0b05a878"
      "67c4656825f5c818da35d74628ec85d08d398644573789a1018c1a21a4acd1012a10086b"
      "00f96d6083abfd79337c0a3c44dae81cd14c2a4cad615668e0407bd305f77179d26b17bf"
      "314c0437848334eaab3ea92f27ed59ef928b7d03b5bf1b910033eb416772a28e36399983"
      "9175d75bb67ad350df97ad2d20a262e2e8c72e0ee08371d8382645a4237e2327d6c1ed60"
      "2a04e0f5658776884234c32b15a98a7cb4310cacbdfddf80cbde428705cd193a7bd2fcae"
      "9b8541f06557348226a5d18f9668b4bd86ef9171305ad9649ad36481766eb4da18047bb7"
      "8528fc839226c0f4b13815fd65501a5f43ba7f5cac5249115baa6c78d6922a92035497f9"
      "3377b38483e9902ecb495027105254667ac1039e6abb8a70ad170642d79004bb9e5dea33"
      "d6caa8faaf6ce0f8edd82b5db64401228e8e590f2af64bfb58dc7fd07f449e6a57fd1245"
      "c5f3b21cde2e32d73f28497654d53fe4a9fc6a9d9c5e07f1f8b1cec16aa279ae4a89b88a"
      "58f04854b5c29fe6ddfce9906f8fbdb3454fdcba69b599935523b8dbffa48e0ebbb6c7e4"
      "9f8b6cde4991ae5ae8e73ad4e3c88d1be12dae46e9c23a50ce7ae0b9e07c1a9efc075dd2"
      "d7e2a215042b19ddc8c28f41a20415620825bccfb9cfa07e1280b646d591a863fe6b7b00"
      "7a8b946e51062a3370aed325d2e7dda1ae4bf5c412c41b2aada6f583af999aa55e63ab52"
      "672218c1efa4197e73d1e1eaf8cb9a0f0f790db781952ecc670a0bf0cac8285ec02133c2"
      "06d186cafd560b6de563c813d57993db2e57733999c09e1171dc6f9c3fa3a4da170b4e88"
      "95587f389d24b395b5eeca1d8bb9445e022624cfbad4cf20b115c549e8e6235bc3ebeb07"
      "c30275dedb5fa2912f948b372c4a58c51afe63f62eb90e73d7f51e8db044719959b76975"
      "3725c1e67975c8ccd51a5480c8ef45dd5aff6bda0038ac67132a374fa6d6b75e0a4941a9"
      "e362fe6f5f2dc72f8066ca9489c81dc2fecc7c3c14dc19c8f89c7cf38dcb0f89c95819c0"
      "22f7765de3eb69c28c29d2b2a428018cc80a0c8ef8698ed8d256819f8dcac8b2b5cc499f"
      "c10dec93deef6fca8c2d80ae283f9668db5329eb2cd1c9cc92ec779cf0014c8bffc5b4f2"
      "83ba484369f057e0c075d5276dc6731186889941fbe199076c4580dca0bdafaacd7c6c13"
      "494d42c948abeede8dad58dce340e041296befb48b3a2738f0948cfc1e556043283154a9"
      "779c3fff7afb164b44af1e13738ee3544cb8c34530e9408278eeac1249f7491983b21b09"
      "e85536cc62132105f98030f4b64827db9e9e4e2184d80100ef264e5e22708fd7c7e8cb33"
      "33fd64f8296076c3c870c6e5e7d836b6c9ae1b8a1bc8f3a712ea0431273a24c245a449e9"
      "c8e441343029afec9edeb101c1d8c9dbffabc1d17c6818d4d4f7b96217bc5c7aeb843ae2"
      "50aa8f946dade5df1e9e6882695ef58e43995b8f68b6fec10c01b0fc4a37d94e9c3880ef"
      "fda57ccdf9d72e5a1206288db08812639cf3a3b3bfa76646af70b7927e49cff1977a4368"
      "021c0f604b836e9b876f6b9140f5045e88f268bf798a72b04b8df18a4aae9be79c27d483"
      "eb39f7632a18a351d87870fa1c5105af75dff136f44e5edfa6e77e280330c51a8e841a8a"
      "3581b60794cfbe6ca3998373ea4a2a589d6346a9b0988ba57a852368d762ef9c4c3de464"
      "f971212a4ec6fd7dfa9a525d0be17f43b97d3240b09b33c3e8cc5ae2dbc2a736af44d55d"
      "3acb18c226d292157d6a59243483efb6547464208004e07dbd0d04f4487d1fdeda1a3df6"
      "3a31239beadf1bb0368a4677d5147ef2d18a9a91cf0105dccbf56f04516bca3fee8194c9"
      "b76ae71ae2f2f2e2cfc58c70dbf6054c721b0c5b08551b0387c3e82ca272128c70ccd005"
      "7ed4eba9f9d08663753d57d8c5ce309799361f8009ede59963f4657b2ff7c95b997e577f"
      "6242ebe1c137c1c3f03b4eba314097927e7fb98fc9ba76c141bbffa705526a511e75ca52"
      "d08c1bd88908df10d307adf603119db56217c2db92d47643d972c6e5c431d5d32c0783e4"
      "64bc058a2e3207fec16f0a0cfe44d5586260b82a625b383710a37fa33f662733dd364e49"
      "137712cd57223b76773cfcfdf845b7659ccdada5211c2f12889a4465caf3f138d7a90b2d"
      "202c0451aef799175be5f3af781272e730985c62c30e4450058013e0b2ca758c0b27e921"
      "3788cf187a1e4ec8ad456bdf9a0308305f98f304560216d3a95f078291e66cb9e8f6276c"
      "b758b4940a997b6063d41372cbc9bc67edc56510d572eb0bf7d35226dc5795fc6c952cd6"
      "799212ac527907e18fe78da43121faa1e3ef77d39bb201a5fd7796c8bc04b0dfd6a84d9d"
      "12cda260b183bd0fde7095c1a78ca0f3de835f91c1b075356bb044f61f90ecaae69b9293"
      "fd8560912245cf7914230706f611dfa4c47a19f2b2472922fddc8667b9cdc4f212c4e1e6"
      "3d8308ef9558e248141e4006be8b860a049435ad183427619c0a6fa15e81b8a16a438f06"
      "1a178381791e4026127c378a1299ab51937bea30f99ccd63be77805e274e597571f7ed0d"
      "c534eb700605ea3b2a5f6d31e4f228c6fcd56fc2abfb234dccf80351ec3ad9024d844bbc"
      "3b22b476fc846465c900e9ac021594e0c7e46cd1ad81a6b6aa4dd5921adad1f15b87b2b0"
      "b0236ab0356dd7e127c854d11fcebdf43cce59acd70dc405a98ad51dd6cc2858baaa81eb"
      "5a56abab22799c30c152627af052ef94c1d80f28afe0aa149816807baf5bd1c85da9d40d"
      "2336ee0287461a026266af7cfaa64b952a5eeea67117db0243c33747a68e60e07facbaa0"
      "1d6e4e7f992493b594b2b0d839705e8942207b2983a9ac808473442a9fb47b3292cae218"
      "986071254c4065eb41c28fd4e68c0c55b36984ebe755d712e5014672b88b3efd71c9a70b"
      "1b2af8da4c5484f0708aa9eb7d64f42dc08bf5cbddb2d1e38831d7a511ec2f4026caf2e4"
      "43a86f2f9afdaa21b681d80088e98500f96f0bd31ad386015b85dceb49180ed9360b862b"
      "3dacc3613c83b5bdf636c55c7a2e5a22a9a94ac085197b741b650f262a6ca4a02db4ee1b"
      "f04387b1cfe838a2013f66a026b101842fa4e44965a80bcc9ff0569503a39fe35e7469a9"
      "0541674a04440e70353ac24a7d2d98862da84c34fb7b79983e209f29e4ad6684deab3780"
      "79333f42c1513a986063d8243d453148c42f10f88fdf4610fada491b781b7a1d9d890ea1"
      "883862bd620399b1611d543613d2202fe86fff14c155568461498d0780e3ebf1fe2c0f2f"
      "857f6cfa2ac4ca1088cc7051463dd4fc6c1c297b627c54af3ea97250af20e585fa06fe22"
      "12f751f397073e8ab67630a75bb5c4d6f2f343b4cf0ba851c16fb904e5a1fe66f0b2e8ba"
      "c618fd2cc490c83216efe87f759705feef7e1df3c0ca649f641c1488aa2fdfc4159fc34c"
      "0d61b06c9d5ad1816bf7210361497d73392ab294d3e6214deb3e6429037ef38add1d172b"
      "9157ddc7d078f5578704da7292a03cffff71145c5124a8fe9a46a7da10c071196d1f9175"
      "c6e53585756980124ed7744922acf08378ad0776d4e82df020b14d1c2384ece2091373a5"
      "a0c8b7301391a4c73066178a1515285b2e4f1482858ea91c59af49bc5e3d268f5140ae02"
      "d78edfc715fb5052b8fa99d2fb2287832231ed38d98432f5afdd957a06ad11b0a58da422"
      "28f3106508cb04702ce79ffe526a5f5dee1e9d026ced1ee06eb921109120034556432b89"
      "f6565d10f4b9cf7248faeddbd94a317da93ab8d7c93524d0fa2d270398acd02d36a43f6e"
      "8e460b4fbec62194b73469be9066968cbc10bea2acb1b98369a3842975b940fbc875476c"
      "1fa7400ee95733ac6eeddf8353e70d60c164d4b229bc361d7e38a60453445190caf1dd36"
      "84c491efa3e0abee650c21c37734b6f8cb2ef851e7e8d98aa5d2399f1768a2cc81020b59"
      "371d16510bc1e38374922ef26159f629fd7bd7bc40b3ddb4ea2a1c7bc4da6504f83beca6"
      "e5163a12f72b26ed6fd219e5edb7d316f712311f57ee16ebdd2153e981a4890ab6344020"
      "8b3dbbcf7f886ea217cb82608a1f606559268d4f0d1ab16f4bc0dcef971d8d3218bfccab"
      "87f704de90c418ebbda7f088f4a52130d0fd12bcbbbe6465b96ad8e111042560de47aad7"
      "9bd1473c882bad2fce71b4c78a3b99e4f9b405e84fddd6815c6c4059cfb4b896880fb01e"
      "01fee33c9113a075c1107824b342545f984d90d0cd29e951dd482ec068a6c4fbc02f86ba"
      "5ca1bda0d847972287e6715cf5975d135c14bc8a9703b1aa6294c44a50979d0d789fa997"
      "a41f00899002a0f2928b6bf2b57dda37ea5d38d06e12734b88f566e5ac6d9be1f48afa81"
      "5d7f2f0841d3177105b348379525fcc9a6a5fd14953ca3947ca43cde56eabf0be2867679"
      "a632c291b8354fa0e4a0f9ba5ba2f2122c4e31d2001c0ea858b466dcc3c1c45cf8b19392"
      "073a45ed261f64878021d18f43520238d0205dee2cd3e6ef878d407f5f5cb3832204f4b8"
      "0ee92174bf3f470c6e1800499d8d16f03c0d2946c460127a873dc46021ceeb84c34d136e"
      "fdfdce8283daf3aeab90aa4f1256d5509838c96349cb88f1b817c94177e89271f3c464b7"
      "dab45868a80f52740ec504334b87b1ffe7315d13e76ea8379873b89c652e7ac098447523"
      "1e71c67144a0c59924f96dc800d09b00a3a27f86f62f79317f7fc439a5e235fce80908a6"
      "0256543b5f3564a8205500b26e4a7d35bf60251ad8d52c8d44a6e3d0b111aaccbd813f1a"
      "a042b554b911bd3385e26be1af29cd0d3afa204e922a2ee039875df3fdb5c65636939a18"
      "6304f9e3095bb82cba060b043e138f36ff275e00ca27ec7a57a91853f19ee520d9a3a9e1"
      "ab97d57683e6091229180b6167d566982ef0865a70e487e27116d7ca227e7500765d4ca7"
      "12cffd73dea70f138714221f308548c2fe9697a5a8204cb00dab455223b21dbda4ace383"
      "b4c2d5cb8a80b43a1cf80a85bcdbae443e7cc65931b7d9c395a09d85aa04a0b896a1abab"
      "c3de81b258f22af403b0e45923c8ef7d2f68aa224aeb1261cfa4f645649c5f9597037eeb"
      "fc066e517495d983e1f0461c651b4e425aca81ac92f7d624688b615d61b0dc20bacf5671"
      "0803c549ebf9a558f652ba4052026c5725e0f17a016eee0e070c1a857b8bd6d920397072"
      "b5cda654653a4ae18167007127ede81aea309b7a226293309449c3df4bb06bcfeab20b9f"
      "d0f7a682a557269bfb1030c7d87fa7337fec56a7126e553a65869b94b8d41925d9fe4ca1"
      "5de3b916d497206bf80fbd657658c3cd59efe2d3e16f9886d48eb21ac931e9831fef5e1d"
      "8b0c28b0935378da0ab01455fb9e7e0305b638995f6dc7c29cde4293f871fd0318419a5f"
      "d289a1dbc78bff788fe84c5d85b0eabde25192665f1a9611dafc364dd2c76548e56c0c09"
      "f33ddcddacdb858e689ef60bc9024069c836cd9231a25c204a450c7a141ca2b6283b46f3"
      "9aab490f368d5ecd8dbc2856ef94d48106550406fce98f9cac7703694869d9e9d9d56ada"
      "dd6e5d7938503fed3e7f11f13ec55c87f9582e6b6b803f4359e4f1b1f0fd64137140da02"
      "4169208957ec32301644b68fea7730fe73b03be378ab66d6ba0d9a95f44572e577ce0af4"
      "d5b169d0f5262e70a8056d0e9c9aa8c7e199b0853126de575fcba6c7157789f46cd81870"
      "369218875e27ed132b80688035798300e01d621ce19a80a712a152d04eb4a1329eef9c2a"
      "76b3d8ef87aa5a4e5a0df0b5d86b5f6cf2a30a14e0eea06fc7bbd9f31bb761e527b1a302"
      "a709e048db0829bd834cfc38ff0d8656eaf35dde2948b9001848b61ca80842be9eb2d821"
      "f4968e4a5ba17c407d0614e305b4867eb10f6fe0fde52c620f171ee0e8431d95c2fe6ebe"
      "a9dd3edef4e38e1c06a447f238aaeb00aeb3a2deeaf11def8c70306e30f361000bbab84b"
      "d2b8d00f7489e11cef6ccf22b2f73f5df1bd8ceaa96c72c2f73479ef034457bd48f180f8"
      "c25885f7317578934adb4d88d0b9e0716f011c7ca6bdba21d9a2287bba225bdac9ff4045"
      "6ecfe0c110dd2a1d02ed119a5219b5532def6e59da498dd52fd0450fc239de044a71e773"
      "c66435a1abb5a717ddb44bf0bfe38e606f3eebf545a6932428ac4e03891d6d124f97eb62"
      "b06e3ba4dd1c881a96de13e30a1dd4f609568cf3509c4aeb66df6ba0aa368ba6840f117e"
      "499d1a2db7f300623ed3fadde6513cd414a8767a153f8e514260e5fddc12f74cd7b2abe5"
      "a8a12268d3e0f0ce4aeb1cb02619795b7a9564f04bf7a66751f45b8c55581fdbb1def6be"
      "c2bc591361e6c5f655c154bebe62bda03d0cc13781351a63834817768044125204b2ccbe"
      "4a34ad8787913d19c51c5fe119692ad88701e41f410d2e551b4b4485cc6104ff8f3a96e6"
      "0d441b981914b6f3a6e0a103874f5c8b5279c822380e1388f8c4e051806df43d088919b6"
      "a96651a1fd18978d9f7b7303d81086fc802e80dbacddca3c67f75c31f9296a6a15671b82"
      "8ffa2144d7d28aff2ef13981c08f29ceeeae61a4abf670a177bb66ee9eab7ba051fcea86"
      "c57279c74792c0db9d7be07b568a29be798e5cabe3f5922cb9bfe291d5cc733bedd48be1"
      "e0b42580ce82b2d192bc91cf834eed96e2640493f452eb90eebfedecbb6eef637fdfb36c"
      "58fbbf19f34d15c965e67f1bd19f8a86954190813ec1f32f9858ad282f3c3bb9e6599a60"
      "ff5a450bbee8a0fda246f1d98ec49f71d3dddd8a3b894123279820f5e5eab5ee35be19cc"
      "dba7484205dac689e5af43f30de1eea0415c1d5844265ceb119755aab460fbb69450d138"
      "5e0917389dd2a8a254c9e11779fd80912f282c97cda530d1802588e37c57ebbc0fdd6b34"
      "afcd00008e3f2860c029e87bd0c9cf9b7c875c78138e181c6b82180f1c2a324157dc1821"
      "a868d1fe05337df91051b0a712662f8174fd1363548e629e1a7ac2468ef99a4249640812"
      "f0cc2793c330e7ae5d8e6f58ba598a75d378dd30fc43825e549382f0998cc63a91bd5956"
      "2fc019463e2ee0288ce8b972d02bfd6931c71e96f1438941f73a9fb0645e21bd830afa89"
      "8cfadeae7092dc212ba3af1bfede863ac1868072674b962c28f9ffcc7c0b41eb3ce3f9b2"
      "33bfeb7c73c1af34eb770f211e36d213d1327c5e115ec13741598df6924ecd5c49d92198"
      "e0690e5853163868077885525e2149476914ecd2da886cca521d9d4326fd0767d4760e02"
      "ebd300cd94f158439b3bce3e80daada688d0d82201e03704a0b7e817b822ff42671ab117"
      "8c0fbef25872f62408a9918696ebfaa016ac83ab0ae6d7e564e4dab9cdf72c2be75e11a2"
      "e3bd421fab646c18bffe2b414db0ae47a2178b1fedb660994277df443daba03359876501"
      "96c1459fec34300902fa7e093a319815ae9ca77a05e36cfc6ca1e921d38e5ce1d435f078"
      "0add12a7866d0e09039ee77696fa71b98b2ddf7cda608aa3d711b36c0d7b7f00562173c3"
      "b1fff6d4b8bda89b59946a0702a1ec432d3369e03707faa4c8e40725e3a93b1b3250990a"
      "ba031b44511c2427f69e82b75f5ebdf39365ef9785786c9db0219b79f2520478d52490d3"
      "cd7f8c369f82ebd7401588c282ee868d6a578cc55fe5bbe83f32ea45b1da7169669275ab"
      "8de98ff73a74296359fcfba3a8b0fc1ba5c077096896e30077237231fb2573b4b564fb2f"
      "4eaab2b1c23da8f350ae14bbed8724bf9f0a99634fbfb703448d30d0e23df250781c6553"
      "97703676e87a1c194988c4c986c72fda703fb3a3e6147e35a50e82780b7299218452340c"
      "f7493fc24fedf145ccdc6db06dd4d5bfd42cb9651b9530109d4678f110beb595c0d34e89"
      "4bcd2fed27f0d5bd494852591ad791987f09f1484a4d5040529435f83c2ca21a450f450e"
      "b7641c8555a7ad97932d2bf415190e91ca48a9d2ad7c5f66198b40c33f2319aa0f877081"
      "061399259a141abe5b8501e3e4597960d65f6e1d3779cbc2f2962d86cfc3a791b8f7b819"
      "fa9eac682de213ed1fe66ed39f7f5be6973d00ee63c9d6d7ebcd4a418b2ba25eb7790f8a"
      "9be0849c254e7123d05f8a95a277ab53929d5b270349b51fdd4b00cdb7f90843da55e015"
      "44592f637c94a736de566ce1febb0f7ac8996b0b5f8d2681ead3b9a20705c79793445fc2"
      "2f993a1e80a5cef83bd897dc24974e9dd779d6f8a532f614a6886e424eef1be0a2b93fff"
      "d2a0224f8efbc65306d275419a42395fed06402da279a57cf7127b6171548af2ec8c1400"
      "0eca0ac27c16779a6f75600121b7461f4c9df3c10e33b649f5b4cb450c9d18fdd199b181"
      "7f092f4709e33e3bcdcbb5ab10345568bcb4a7537187e851110074a356ac21e4bc7456b5"
      "c9039a0a8cc82655a5ad404d0a8aeca1f7c6432972230d605468c674b86e1ef0e8467773"
      "3db6d44ade25808d3802ab1114b56e553bc8ae55f75fc61ce203ad84726396eb136932b6"
      "6d0c948ee67929c1abfedefe6b7d6799743e0d6971f518315652d5ef0b780da21fbf4b99"
      "d543d1d122ceac03d3e08584d692aedba5250387f71159efcf2120779c907bb358badcf9"
      "f72bf7817cf8f5936c19a5159cdecbabd6a7954dc46ed2dd50b58264f823b8dbfcb37e5a"
      "5fc8d418d9e144fee2a4bd1dec0ad923ab884f229e3aa247011f2c78f46c15ceacb0cd5b"
      "579d425ab9478411df734ed88962b8ba32abd9a4e7e02299736dc2c4c6303c80bb434a06"
      "2461eb7b9fa7dced4e993427744488fa96d03cf019230ddafcc0d32a14c2808eff7dfb87"
      "a5088c0dd3a838394b696b33d8b5d9823923a58ad90a24582ea95485ea91296e22c64644"
      "8a4baf64ab5b2f831aee378ad5e05444029f3b885160e2790ab96566f008dc8458292195"
      "1e0ee071b51a5c1ab2b81d1e30e2b2511ab57d85413895fb33b6271f742b5d2a14c4ebbb"
      "dbcb1f8a7ba0e6efef4d95c1ac0d6e400a96e468e6ab948e73d8dae59e30ff39742598d3"
      "c64cada3a37d590784368d3db26cdbaa3185f8085a8264b10ccbc43ec9f6eeb363f006f1"
      "69f0aa4168acde5599e16b161b885761f0c9dcfd2b33fdbbe86f2a88bef56fc46dfb075e"
      "01c84304ad1ea44aca68032de60acc3875e4b41630674ca07a941d72ec4c212e885edd4a"
      "7ae77910059d344fd0545cdfb4170b2b735d575a56d743fc7e46dad742b4dfdd228cd30b"
      "2f49e86761f6c57f6d292a040444817b74d341127d5ca13ed730fc558f182b994a37565f"
      "0e05765df6004e7f288a54f311003c965b06dd41de117f54d41a0482d3276fe3ed5535b2"
      "28e95c12135b7d190b11c4f56fb77f1136ec0d76acf538abdd7d8fccfe0d69d23c469422"
      "83ec4c996b87e421d8219b3fa486d6d0fd83577b8e58f222d352865df77f25515eed1c8b"
      "df7c7bf97eee9ac8e4b7ab35342cab4a96ad1be12e936a048e20c9c86a3281a32663f155"
      "2ce084cecf9cb1bcbfc8cff5a90042be4bf8eeeef16db1ba48f2c04998b9a4e896405f50"
      "d5e1ba8a4c490bcdf07187b90940bc36f973671d349aa772ffe6e708866f97ea7af8fb58"
      "2e6031c12c999a48fa092af5b5c18690a2577c58ac5447b20ab0413c6620b3928ece273a"
      "1d107e78b5e2f3a7489e1b871685814048f5dd9f03771ccca4fe9f8d717687a13c6b6a14"
      "44417985815f3a850fb0f6d3669834d86e13ef59436e1aa6ac83aa20444a1331b2831296"
      "94560073fcd684411bb6c8d8858a932484418f63f610f56b184205c5f88bdf6ddcf0aaae"
      "75b5504042e889044fb2128b3fe8e7736ec15b07065b51be92d5d2d535d6c1308149e3f1"
      "4dce979b6183ccee359982eb55a55c15f8bc8de6e9a30f32067e91f1a662f003b58ae24e"
      "8a0020e5a7b97c7cd397088a6419c15174a0b191db454dea7c3334d9465c4be7af556211"
      "bb1b78c3bd0f45a56530610de62f6d4d592c11de4d0ebe116",
      ToHex(authorized_state->GetRawTxBytes().value()));
}

TEST(OrchardBundleManagerTest, MultiplyOutputs) {
  OrchardBundleManager::OverrideRandomSeedForTesting(0);

  std::vector<OrchardOutput> outputs;
  outputs.push_back(OrchardOutput{
      100000, {0xcc, 0x80, 0x26, 0x99, 0x33, 0x0b, 0xc4, 0x74, 0x8e, 0x34, 0xdd,
               0x59, 0x8c, 0x71, 0x24, 0xe7, 0x22, 0x99, 0xe6, 0xa6, 0xd5, 0xbc,
               0xc3, 0x2e, 0x90, 0x40, 0x9c, 0x80, 0x24, 0x86, 0x8b, 0x27, 0x05,
               0xaa, 0xdf, 0xab, 0x60, 0x68, 0xd4, 0x58, 0xf6, 0x9b, 0x0c}});

  outputs.push_back(OrchardOutput{
      100000, {0x3e, 0xd5, 0x01, 0xc9, 0xc6, 0x3a, 0xba, 0xf4, 0xd0, 0x13, 0x68,
               0x21, 0xf9, 0x64, 0x7e, 0x76, 0x45, 0x55, 0xa4, 0x70, 0x33, 0xad,
               0x91, 0xd7, 0x34, 0xdf, 0x12, 0xd0, 0x46, 0xc9, 0x69, 0x75, 0x13,
               0x30, 0xbb, 0xf4, 0x93, 0xa2, 0x41, 0xec, 0x4b, 0x88, 0xbc}});

  OrchardSpendsBundle orchard_spends_bundle;
  auto unauthorized_state = OrchardBundleManager::Create(
      std::vector<uint8_t>(), orchard_spends_bundle, std::move(outputs));
  EXPECT_TRUE(unauthorized_state);
  // Unauthorized state doesn't have raw tx bytes
  EXPECT_FALSE(unauthorized_state->GetRawTxBytes());
  EXPECT_EQ(
      "0x003de51bc0bf88c124e2a05c0a7d0500d0068e5247c36ce182df2f2a9fa603bc",
      ToHex(unauthorized_state->GetOrchardDigest().value()));

  auto authorized_state =
      unauthorized_state->ApplySignature(std::array<uint8_t, 32>());
  // Digest is provided only in unauthorized state
  EXPECT_FALSE(authorized_state->GetOrchardDigest().has_value());

  // Can't apply signature second time
  EXPECT_FALSE(authorized_state->ApplySignature(std::array<uint8_t, 32>()));

  EXPECT_EQ(
      "0x0210146f89cd6006972dba9b9ea85d293f5c69bc51688220562b00a1101e139d115136"
      "e62a35a7a471c0a68f7a2b09915993244010af0ce69e863a0cdc68042b10cd13df8fd3ae"
      "588a35a34065a8f44b9c101cae444bc857fd13770f2ab9f4e4ac8e8b2ab4593a880e4e64"
      "fe38632dc572ee81165d457484ddca9a5cd78e3729300c7e60d6fb00f4be24f81710db65"
      "4a5c340b219fc033c46b693a76bd62e085afb839bb22f57fd0c06edbfb09d1fc5de6762d"
      "411f2ffdd5d03f7829956fc3643eec4939148cc8916bd2ab3b0ba2cd4f7bfafcc2b59316"
      "f2c6dae7840137a8e393de175a9b9ec1031072a5286187e4111fb31defd6a470f65eb22b"
      "107c72716db2c2d8059aba94dd747ae887da9dc5dbf52de75b93bf646c1d268641b33840"
      "65a8142395be661a987b0b4fa1998550cb8da83036ce6abb5d8e5349b824d5a7fefb432e"
      "d68be880bd3544d71530fcf2acacf43926317c58979227323c54e7f6c8ec8dc42b22775c"
      "ad9030f30d2981f19f4f74018337d2f3f8bbf0b669e594912d1f04cb8d2245038169acbc"
      "e4a6c356276587ed853ace0e09cf6e5e1fe2c757ccf1e28e2246e799725af8677616a822"
      "6c6f524c0eaa52f3f2174fc5a6b38daaa3025ae18330605311dd7fbb6eb8d6cc2e660ad2"
      "16bb938923f0884ae51a63c3867e25fb1ca77c6921b7439d4a4677b401b26f769782cb58"
      "1024f5a52488d3bf7c9a540e6a3b005e90cc7c5fc86e8cb34f04e4ea36179e3ac3762352"
      "9c60f1dcd0b331cbb87dd8ffa432f41adc4be625a4e38f67897e2a31b0a9207f7aed8389"
      "91a67c74fa1f0b483d506a15049f43dbf69380968f7a0fae32f7cff00b80f3c11883ffa6"
      "83220219aefc1342b393f1c8bce65f8918a2bbb87120d140c4b97ff65743368dd589a48e"
      "47cfbc7901e2b6f47eb9c38ae75ecac5b731d3c85f79ef0e124d336a1eb089bc14a849a3"
      "a508c48b51b1bdbab006d1b7345d8234e36fafa9396c5a92f1de36a3f97cb683e5972837"
      "ed93bcbb9b62328485ff39744b02f105c1da884fbbb65bb42c7ce0b4371d0dc4b1490c71"
      "108361afa9647a430db6724e488e80cfae7efa2c6d805c6807be4d683d1f54709b0685d5"
      "52c960bc7ff66a416b4e3b30d72b891ece08e0b4a1c1a3c3a9cc49cfb6ca293eda47b9fe"
      "d29a4bdb3879da4adf43bf6aa4b2e18d828a4ebe767cb14cad212ca95ec8527ea52d52ce"
      "05750a1d67216a3b2f334682f65ce5ea49599bd7e01f0c24e1115067a05420de096a7423"
      "9e4092f62c101ba8002e2e31e72af0f0dc946df5d0da0d5da59927d07d2d138dcd186439"
      "1c308a16c7c90cc2174090a1e134ad14bd78aa49364f297d83593d594ae6287658d59c51"
      "f0999bc6dafd25b6132567af157c104803883953eb7d6f0c1d809d4d219373c7d38dd148"
      "2669734a26fc06a31c3488353df5603d76e37d4231a2558a9f8662d9af27569dfca539e4"
      "4c85d90073382508870f23c175d8cb41dc336e5fc5f9714c93e6df610fb05fa0688235d9"
      "decfd315fc37151b9191f98122f2538c49afca58f880a8160678dd861dfa2bf37a411f85"
      "cd8b8d921d5a3b9e919fefb2b870e0c1949847445a7cc3a923b26e7642070d6f5d6a1cf7"
      "ea28c652d8a03ea3c74fb78765dddda382f92a59651e4e932c45d44d1788aa6c31cfc024"
      "d1cea8cfcab1d7c911cc74202d46b3b34724ea3fb60ceb6868afacf8a2a7a4ef52199691"
      "2e59c185b0d85665036187f0637bf413613b79a8ad7fce78d901d158216449de2e04ea4e"
      "8e9e574ddebb1acebebde56f308facc68a2c2e95f128689692a7f2ea2c789e079b8e1792"
      "2e69e727ca69227db6411053d726ecb49d265e7c68a215221de5a359289398648329e1cc"
      "5374c25ca8258e153ae410bfd0e092cb67d4a8ba29b88a5ed1eb134df555d2f7c7ef2454"
      "b9af3fe1e457f91318144ac52cd97764543ecf11c9c903d830629dfe9e0a82c75aa798d4"
      "d723f372ca80717feae5b57a31be0fc1238010932174368a21a8431832e0cd06e4409213"
      "6a76679a1687d81ace19a0fab0f77b2903bac0f67b629908c2b9ed164d9cbd095fc6ecda"
      "2ff3ebbf3b54509a26c9d0bb6b7b6993c6a7053e1cefa1a4020f14bba6e6328ea751b16d"
      "66d591cee80be7ec3efa7ce29cff977959b304ba09b4fcf8e73a37849e99ed7999be5174"
      "fb1635cc0250f6223c39ced2e0b7400fc07c2f0fe1e307a1f7cbb58713e5b0754bd2c977"
      "bc762adf301d1a758ee265913a116d3587cd3881a2201acdd60795b6da50ea8e5b9674c5"
      "27965d4982435518f801efa4740b57568018c2acd95e03c0f2fcffffffffffae2935f1df"
      "d8a24aed7c70df7de3a668eb7a49b1319880dde2bbd9031ae5d82ffd601c14fdbd708a77"
      "043914b56e699a829d7543a6b26fa0a6baf903b4fe6e260650825da9b1deca22b7dea673"
      "e5ba4b1cb537bf27e5ec2e8cc6600471db7ab5d1042ac62c6059b602a619ba1d1b84b312"
      "d00ec5da040d796472d3539d8b0133bdaf80864892a2fd89929443e4c98d63ce54085400"
      "2c00dfbba9f5404ed9bc4b6b6206b83392eb4ec8293b4b15ff60c022922f8b305fac0335"
      "db79fd808f681ebf8294e078e2b0574e908de4f8a2beb46a6e7dc299bc85db79c36fc00a"
      "287397ec520911f707fee319b6b8a3db400a8a5081912840cad00093ff1bddac4571bac0"
      "2f3a714b7405b453ede7707bda9324173461602b35b6b62d5f4367cb70fec25712b619ca"
      "3bd7e2300900a7b71cc1daa579a598e9cccdbf677a376ee59b359fe90d38bbbcb840bea8"
      "e001b8c0b11413a127d2fc81c5036dc24b3e37fb745ec9f58aa665f0cba9c4b9cfac1128"
      "dad939ca3452931c64b55f2aa48219d78283f1dfa72fd8270392d5c9cee2eb968fc25081"
      "90a996da32027f30cc0b96f40f472c743b2dedeefbd44a9a53488b6c7aff357e6d0d7a06"
      "1f99e97dbc2314d9716fc2316c20151ad866601293549ee30c0bc91773863e64bdc9ac7a"
      "6bf9741331a25c0ee521d0e2fbfc65e56f130a95861204445cf093b183e8d3f75a792778"
      "ab3e71e9961c9c663d980eef638d80eb2c9cf92b61eb8cd347ca804f7fe40f4a2e769006"
      "bfb67df34047555df0e707aba99063b4f8c43d55bdfe1e90653ef1b231d328b160b936a7"
      "3207a46dd58bdbee8e68b87e5b1c0f29fe149ee9416169463c47b804cdaafe2e644221ac"
      "aac62c45c191d5e70399525fd971f2c7e8aa2e4c71091adb250b1550031f79f38cdaece0"
      "5530a57b5df3838b8e417e19bdea452b97b8b9a3c48a92ccae9b33a195187b61b20b5a9c"
      "1756e42879bc456db2e67395fe76d0a65d3a74fde7a7ac56e69eae18cd9c4033988ed2bc"
      "1bc65fc5762d2acabbeb403e2389629fbfe22c6b6735d3d429f4719c5d41d9d468d4a562"
      "9cd0c78a378bd58b973752c3d594bf53094361b55866f94ceeb846e2bdb6599fb3c8976a"
      "fd3c5fc39a88541ccdc5f1c17241c8ed438c5bd2c53c03ab80e26d8d958da4ec18fddc51"
      "56863b966b39b432b185c092758ddee02c03c85262e64c4eb6146ee87218035bf486942e"
      "53ac043d84e2b2fd591f36a5305398ae240d8d8546431cc8273b55ef229a64c74799d2b0"
      "07025c6fa902936f1d2493c39e647d2f2a3625fa6a939a40e8b3b25e9b48db73711ca6ae"
      "7ea014f815618b9d3693a6d33d0e75199f09066a3b87eb87a8c2a14985c64fefa7931530"
      "67a98223fdc56501b0ff99a4697a080e010a6878aca370a1263110dd094083c341209031"
      "fb1cc81055d95a7d4e2c7a7646b3a6fcffd8e285f1d3632e43572bea397e6fecab7b8b06"
      "d1192d584e0f16e8d084306730f3b984233af494e839b6bd0d70c93ad72fcb9cbd31085f"
      "2c4e619286bfe1f87e32e70688a824ec158adf777ccb75ece396c22552797794cf4ed664"
      "7eaefbb4e31d91adc410f5297839eae0dbed84718026e80636932c7daa1e8810f8160c26"
      "f32593e36c704d63ae6230ee416074bb07440f2533e66f1558bab2e1ea042f67a5b0eefb"
      "41e4850e80bdeabb69afc86de6cd65cd4c6bac40b8d2115dc72134901b1ca397d7951196"
      "a0708a3b664730f4ad153f51ada1f11987777c3f94893b761e1eaefc2480b6e5c6cb7076"
      "c3382e5ff8934fc1eff1f336d89c9915692ae1d0ee3bf2c11de33d34431017405e598a09"
      "f0e898951e35bd7d395c1d40ba8807dcfabceaaeed192a3914697813d24e40267fd3a0f4"
      "a668aa83b939534580b58fb3dbb19009a9d06c18061b39774f01aef77ac579349aabea2d"
      "f2ef3d8c95bac376988a955be7dbfe46882e89d1289ae802574eef0c95d9066411e08cf8"
      "74a15164e62c923bad779463c547e04529b82db0eb0a4afa80d117e44c0415ee2e257e09"
      "2030e70c85ac26062d704c01bfc729b2c56319d98591da628d96797aafa92281d4deb92e"
      "3ddd620989a1ac2cde66cdef1e8c0be90308f34da57e353fd835a8420310bb8562a8c73a"
      "66d9e61d734ffc4dae5a88f1cbdac72f515e17bba02b93c4a6f565eeef36f015cc76316b"
      "76a04f92e7ad63ba2cd17e4ee20d6967d317528d1739efe1ecfab36384b0046b8065e7c9"
      "17699537df0f99f6071853302f2342ea51aed5f127950260cb7ca3f46dd8332a2afb13ee"
      "f905576fc94ee67ecea273804057acc6e2563fc2b8a82de582a111f54f932b5b820babcc"
      "ec5b2ff27ea46f0c19c12980f040764540f793771eca8ef28f3f6c7d209b3d4d5d0581c1"
      "95962864290c593ab53fc60fc0f51e983187086e79e4a74822896e3cb8e472fac1814085"
      "4b72fd37e7ebde32608b59491edbb991dd31c81da7ab102d50b82910e11b21c386ff70ae"
      "d60fc09809a03f4e6da463bd6581bdf830a00341349eceed1f083e50b38ae5041f6fa218"
      "56e9f4846871e93c487215ec6dde01cb6ca26e76ad23905c600c6b81c836f5d237d91661"
      "2557f18815700de84b0ce1dcc247e2c67c0d593742d4e3a065d218449a5a582b1d45f003"
      "25c2cef48ad24a1f1fbe2ef55c0e387cbb4ead0eb7ac1a5fd23bc1bdf1b30155cff99571"
      "d1a5a0a8cdd6979de7007aad8e3f1fd00fb673cf1bf738354cd1f94029b4d946a3fdaa75"
      "3399e7d54220b49a040266e96d08c170e57ad1b4fd302142b2f6eedf9a57c1278d5db0b9"
      "9d00df49997035cc69ed37016f09746c63434d2b0aaf4a35d5a9dd15806039d7ac17ced7"
      "676f96541144d13bdb6e38224eb6894fdcb71b7260de5d3c0a77ccae853f663294555d9c"
      "4aff82ff63adc1d910bf8daac3e79e584f0ad7d1ed2ef21c380470d218ed643a6b8ce782"
      "abdf4e98a7fe4bf904e5d86a70b6aa21d4d09101c22cf7345ae7b4bfe2350e7c9da2295f"
      "3ba6edb1c7d93db5a30f9b6a6169791a7830f652930e4c59ba5f1350daa1f4086b5f83d7"
      "f1923287284287c2a844b40e10120cbf09fe9101cfc33222e20dc82a753c13e2f9ada88a"
      "251d52a27abbaeb5621a4cd45744dacfda5d6a78053ac5e7f1e80fbbb4353395ce1dd1a3"
      "093e8e1b572334126837b94c7959522889e2acb91ef71567842ea815217f444e6afcda94"
      "630bb03d4a91e5368df5153b78675a164ad5500d00a4b255bd6d681ece59e4c2be26f64f"
      "90bdeea585e3b55fbe9b2b6c991a20fd0cb7897e95c9be3380fb65d1cc17dee626537fea"
      "8a51e7903abaf3101dc56e35fc218a587ac944cafb49286c5910a22e39b027e7b1813663"
      "23870b4be5cd7304e5b9ff8dd8e1bdda9a90d075a22db4476f5973719afb078dec2c3db2"
      "7bd1465388d5c441c1daadc1b8c934fb72178f7cce16be513189f9a4b31c0f833df3db37"
      "5eb157b03e72d0ac0bab294d662c62a5591b264e735b86af778cb9ff66862a44887183d9"
      "5bb428abb2d3b29010183d1a0bccec922dd8e837dc0874659dac20fba57fc8c8f61fc5b8"
      "5410fbf37e2e6215ee69a3fe4c712f67f260228f56992d8b7ea95109682d61bf6b814285"
      "b12e3c7775379afc063e52346bc17d76000bd3e801e84726382d198cf1e83aa9fe0d4402"
      "ce579eb6ebbea50d8b6be0fca4cd237449c1c498e38bba7deb4b379e1709795883ae0a8d"
      "72d5168daed07ca7530bef3eafec8196376c7a7d92481503852afd4c749ea3b0a7f5069e"
      "f34bcd4c14b852b9462c74afeb00cc137c51ebda4806449db757bceffdda229601073cb8"
      "c526edd498e1c1a0326d9d5c7e87f1fd2f0c778653c074453d339101c6927ea8acb04967"
      "60d40a31e966619a4884532b181c9c695e531cb9ae05a5e2912cf6ba85c4f57521aa2597"
      "effa8cb63568fa77322c9aca835899d92cfff166063afed2a31e40b374d81110211049e0"
      "36283b1e5c3b699ac75866e41c7680af482af6ba43bdc43b9713d5443ce660d9be5f7441"
      "19009a1923ed4844efd26328aca23ef510b478869aece0e471cf5d21d29e9de516348497"
      "6a4d912bfe16388d8afb53b5e9acef4bca72f0f1f5514f61cd60898c5f2075852d26dfdf"
      "da3f93550e15b73f989bfc664511d7b903de7baadb339bc55c1365af15797574a0f44cd2"
      "0db12bbc397311c3701e2f5f969069db8ae57745da319c7fcec3fa8e2d1ee8fa21e10088"
      "e536cd1e1ca2ef8e7d7c3ff376f39c31d8372013f5d186475cc112d5abc25a96767cc5f8"
      "c261d4d6866489febcbc39d4bb36b26276fba9d688500263f4476738535537bf6af6da7b"
      "a53060759732e242ba0bb8d8a3ca89827a9ceb021bf47a7cf825587e509570c197f1e18d"
      "c5a8c3e9451637c77300b6e423e1c5251e3bc37a1389d0587d7702f3796c484ebd9cf8cf"
      "a53a6f4469451ecf2735018bb06c7298060371e624d1afdfefd1e4b5e257fc7db400867d"
      "a4c264d72ea460e2917ce57a4c94ffe29924cb84d784fa789a70a7138205f8bdc0001403"
      "955d597223ef96bbc144518e9d6d9d3b7d17b444e754133acd01b0143e7adf74a5526cbb"
      "62ac2728911275d4fc2163b4e5c859e203473415f0071ff6e29585a492115ae7e271559d"
      "ed725b70c9e534b68cd0f6752eb1cbe03c014e480277db783fdf2adb615b6cdcff4b1fdd"
      "d42415950715ffb43a891b05121587116ea400412538d6bb82ce2c4492ff17ebbd8b1e9b"
      "81174319686f75560d3a96b63409ab317ac49bfb02922bf7c4c504f15e9626ed0c63ef90"
      "e7aa03b2681860c999c96d975aea91188d26156692a5e3fc23b4c4112fe5a37321b09ecb"
      "3733ebb05fe3712fe46efe77f1dbe228dde76534725449bae762d43fbc1cdcccc73d007f"
      "0eb97ca34be662717397fddb8a7ea8eaf7182ed7d36c021cd4bbb77b93382be3b7cb4920"
      "edacdf918c00d8c14e7d297569ff431b265c285da0a92d9e581ee035be78a438010a6fc0"
      "81ef342f8b933f8a677ac6e92a5c424631ee5136aa2297410ef9ec73998f929f01103489"
      "b72871d713bc7a25633a0a4f617f1d5ee7030486f80f900e24413506ed8ef5228fa891ad"
      "09db4fba1f98718ee6682b1016023c8ecd334440aa576a2e253e62050e73429cbdae920a"
      "75a74a106fbdf06a8919873c79cb98094b99e2b7a86dfd9c573ad6357cb9f4559429cdf3"
      "8df3fdf26302daee27b1ee4f1d18a8eb6eb0964b30d7b4fbf43c59ccdbd292f5a278cd03"
      "82196070e047e39492755c15dac6914cc5febdec0ecd4a527c918b0fb49fc59b231136b1"
      "bd9c4fd21a7515295ef3973061a3c1674df17433c5b78a3f1aecf184bb04e93dbf4e0cdb"
      "d89ce5df2fe1895db4950c3f2fd3112f640f3c1fab3c56bbb53d94e2f72aa6bc8eb0fed0"
      "bbd4656b0d0e75c8cbec4b05f781e296f9a41f2a5c12f3afb9945260bb7bc89304e8661e"
      "d79a753983ffc397539bf884ed1070a3bf1ec195e25569810d37925a2164294658249ee3"
      "3a1a564e7fbb25df8e10a4246a2e6dfbe3c4fd5edf5af9d8f243fe56779c20b536640aa6"
      "48a2ee8a9cc1c62ff61ca3582371b60d51772635c48154555a03755c15267fbdd144aaec"
      "97d02357132c1007c5e9dcc0cee09947faba92daed5c923387217b32f1cac0ffaa35be45"
      "9f1abc5a58279725364e397b37da8a4ac6cccdf7b8a01d0a06907361ce215737e726f320"
      "9af34b84508fd4e7f411d5e8a3ed8fad35f7dfcc16e55e7e9e6820dc990abf70f84b58e2"
      "d3222f6854d80741e71e041e54ee1e76c30548af7ea4ed5cf12478612ecebc4ef193aa27"
      "9d37da8301f9aaa14ccda4b4f97cf0e0ae1f1fb9a72ee03ade6441c3512860465251d5ab"
      "2b06eb2ddebecf44312aa59945a12128320a18bc5d171a87029c7c383f288f6615a5a9ef"
      "bd5c32dcc6ac2276587872aa6b30fb8183de8b7c248848eb638f95d778224b35454e1e0b"
      "9dfa4ecbb96aa9437b10c79de12109dc0c7af52d62a75a83b8a0364799d1997a3f1a28ab"
      "3dcb3765df040583272fc1d508878c90b45d3ed91f012703d8eca7d44e9cd2e5337644c9"
      "4f1dfcf01d991c6210df806596891ec1d468135822e8d87f759fe13dd9d8303e03305f0c"
      "0f4676e9ff253912446db83522ab968821ca02bacf2c02afd7c0ae359a2d0d9f0a79a5d5"
      "93d17bd5f47f497d7195ee880ef4343d7a7adeb9538042b8e70f7b7398349d61f182c1d1"
      "fcd99e0a7ea10f9b50888215c75f4ec311f5f3c0d018d00dfe11988ad36603a6f733ff49"
      "2e51de7247fed3395bc8b1e568feb08c082b9cd52371b3571c722ef0218b582ce436a331"
      "21d547299c829aee1799fb2d9e3499a47bca9836bb46c0bb19bdae6f94e2df4a8ccf259c"
      "df256db48d902e5a6f2076fd9b8842ce11dba0ee0370bf4e2e1b1267d8960047b03521b1"
      "ad00470de22ffa850fdf560fda591c5d3c4c5fcc5b3406d104616dbfcac900ea64bbd874"
      "1c08734942c9ccdf2c21324b2c9faac15f9c59154989964c08238c9522039ce7900d606f"
      "0cb89bfeaee3e32e9f981b041413d6c29a65888cf427eef6dcc29d4d6e19fb37fd3a0ad2"
      "131c54631a1d0db6163ac2e38832d2c510fb802db32352f921194bb7789a234dc72bed53"
      "4ab4d270000a452e2390ce3e4eeedcc4005c6946390ff8efb983a204d7b2f2c0361c32fc"
      "302b6f0f54d60c940a12e67a8d18a7dbc123248850524b2dbb78498a9a08c9e62051322f"
      "6a14611c4028f77e0e9ebd2bce2e8c6f8e83ffcd1bab78d773090fdd7449364e755511dc"
      "78e8d427e16c592269248215c3f77084b8c1dc87f0831c931e47aba0835437c1e3e6b65b"
      "0ea3074eb0385f70f8d8c4d38b2faf2f8cb456c50171c051eb0bc71c1a228d018158ceee"
      "26018eee783ea3e28046641f7c1ed46f0785cd7dbf5d0b6d5b1ce1625bd62328473fcf2e"
      "3d52c7443dc9395f7fa4c5909bb1921116a686290369aa548e652967e11e3ab99fb4e3bc"
      "4a168193f7dc56313a565c81f2365ba2d472d5f8fa209f0d5e219e4cadb0b855727f5037"
      "b6f13fd85d3052a1e6a5970722a7b9a214223306bd0d4f09ccd78a27afda4a3a4be5fc87"
      "d03e2f60e11028a64f8df42ae65ffce766150e293e7ff611c1ee91178d444b93250ecce5"
      "f2086ea0c82b84561dd9f8eeeb164a950c3b694c37a15d051d4b7f9581fc1cbe6680ab15"
      "885bf048bf7a76c96e06136525f48ce4d1c0f96e1f4ad48f89283531a45b401767ba603e"
      "f7cb655d150bfce708eb4bf7fed3376c6439fcdbf687594ffac0b41f2db03f1f880b73f5"
      "3f2f1bfde0902d818a5ee59b08c4a92e0e8279d64e5c57df0c5ada482cd01311a5137721"
      "5535e2cbd6a2e526c596f29403436ba222193494f6f2c8e752832bc0ca1664431d09927e"
      "390608e1d5c4f9cd8caaf2fe732857c13a28f385084a04b9592b505c3865fd10ac44ba58"
      "c65fd2757639f2793991fb912273ff4271be0bf6350c512c49897d5473ffed7d2e5a211b"
      "20080d5a5666d5829418829c0516b28d253e354a1844c2238bcf26475e9fcbc0d0258a2e"
      "21cc3995c251928a595934aa771317e9043eefde692ab8f2e5bf4ba0a153e7f3abeda6a3"
      "0afc5643550b226fbf20100069cd911071cb996cc1381d0e57b0ce3511212eeb666cc816"
      "abd7c091f537229141bbf66a4088427fae21ac9cae54eae415a6fa516f25eb13ca4cfa35"
      "433cb286206acc7882bcb59fa26fdfd2867e51eb6fb83548826a9332551eb2411b08516e"
      "cfe80adb06b50aca569911594a5b538905ca22b295c27b81ee5f72980d2232f217ebd5b9"
      "f4451ae75f615bdb4fdeac6ef73728acb7d17771488627f51030a3f67cec9c7c13030846"
      "e744eefad52f75e05d6eb37ea9c6aaedc5994a7bdc2b1c2a0a7a873cbcfec6c634c9c965"
      "3d360fd30575efab4dc4aa1f89dc40e49b3842aea78939400f42d89b29921eb77cd9629f"
      "8c0943e4d6c81fed503f82818b10f06666939a403d802baed1d4e79deabba2855c462062"
      "78222fa1d2466053550f840a3c7d120051459381e22f5354032f3cf5e70740e2dc31406e"
      "cae60ed7bb18c0735ad1aa1c7dc8ce6589542833f0125261d1c7c207d3d57ed754ed58ab"
      "572f20a5a61e31fd774d51be1ce8de36d7571b186723314440bd9a4fdb90324eb708c448"
      "9fcb47b67e81411a9bcaef9f480c52c29f37dc596d71179cd1fb1240c8324e1503704acc"
      "7f792aed414e56bd3b6fec9e6aaacdf2fe5a64581608591255118a21abe92ee9a7ac69f9"
      "18f4608b1da6f60aed02ddbb5fd4f9bdac1cd3c13d222b46f63ec7a3f14cdbf0148fc7b4"
      "c4f4e627fd2e604de774012b8c592edc4738f9f246da234dece1b3f11c958b75053100c5"
      "4995f728aaa52ff094b22c4a3a1a554e0e15c42abb258e2f6080043c596aeebbe55e85e1"
      "f6b808c6a71b7f009c389b62b1894ccd2c3bbb9be4d4c9169a49c4339a72a795bec066af"
      "aa38371010272f7162ee8c3d00ecbd6ad909fd2d10a176860f95ed2e276f9b2af5664e3c"
      "7f04047d57475b4d4abd4a68fb5be95a3931c15bf03474212f689817f45febd36b17035d"
      "6d6ce3be89dbf423f672745abf6192531aef629b747aab01387f6650a41ebec35cb26706"
      "e3b5b15e1d1dfbad5e0584268b8c5e855d3c7f5fcbca57501b1bdbad8450d4ad08938b4b"
      "8e311d9e64a4dd0c84f3802159e1997302f7af29c00add0125b03aa7e3cec12d08aa36ea"
      "a9ab738b2c234d859614ca1136699ebbed081335ba85266500bad60d08ece62f65cfc6d8"
      "1bd8ca9fe5eead80a3df8292c03714d19f980ae3fdfbe40437c32706282d9c39be224775"
      "105f9661efc6a4e7900c744f9665d481c23d147f29ebc8d49c2f6430bf4efd69fb137581"
      "eb3f213afe2758d9ddc6d7a22e9d0f2528d5493f8409904028dbdeeded1108f3fd9d7716"
      "703f526700ca10a1cd1f27b773bc933ce68c1d254460b85a9d1ffe3503bd4bca593d8926"
      "07ccdb22e5d43ee1c9550575cebe109dd22d4af6124d0bf829ffd4fae53f58f9d9c67c31"
      "d6096e240a8541bb06088cc2d70d20cbb53e6db3abe6def5402341562dd291f8226d0947"
      "d474d339fb4bce5efc9a9f73bf9b5f0b5f65af263719a33a0f38bd0301642f7b6d0e577b"
      "0c5d4e130cc5d468623db4cfcadb213d2a2b1a0eaad3d2734fafe85254d1e011cfb3a9f8"
      "ba5416ce987a36a02ede5ac4360db33a1b1f0e731952e886306c2bf5c81267f623a496dc"
      "9ea066a99c83b3b44eb95c9a6bebea740d6eba0d1dff41e1daa0aad8675808553f635f19"
      "4006eaf6c82bbdd7f9c38dbe0547b5886a3881a581e2171ba14b54a09da68a8fb64fe827"
      "9135151ace6dc7ed8df8570ef1522a7eabe4148174e4aeedf3c4016e22ace6c3293fe7cc"
      "f5412af5dd77b4150b47fbb907a233399c031277b21410742e86eb3f26292e9f5f6dba0d"
      "a7c51ebb7904d7e1e61a302f0de75470914327fe2646427371309519e6dd815301e56d95"
      "2e71970ed1241508f8deb16c923bfd3708b3dd5f501ef434e9349d708185d8b90f6d4317"
      "22a0b9adaffe5632c1d60c4655d9397ba3b7e5e699de846917f37b329bf3f0969a537e79"
      "1e6289cf9b124c9abc177a86701690e1bcde68f3323b99454ddb367221195c7c641f4be0"
      "58b9e4cfdf717064473a63bad274355c73712fb3eda57c1c860dfb25d2ad1862426e4ca4"
      "a3d0213183b05556138298815679e9a1aaac22fe1ef0d1d57b54abf10d6b736f72469399"
      "658913249e4281d47cda1c3cb43dd557d62e5cc1adf66e5eebbfd10cc2c3828a11bb4241"
      "97bb1e6e6017bd9e834bfa48da9132f29012df7c050211066ad3ef0f5783c7186a545896"
      "4c66288411db7be8be619b7dd98e5f14086523b285da21ebf93912ecc1535a5425c72139"
      "27b000df0c9fff8723c636e7a30ecd4093fd168eb5381ff07e7a82b5715e485906a064d7"
      "68ac092819d7a235040bb47dc3249b7f779b6dcc38bd66489031c0302dc2d79a551e4306"
      "4d9cb2ff5bb7278e3104e83873bd7d4ad6838c163abb931ee497a23c6ee4e213c349bb26"
      "9d67a55ab7fa9c269d18fa12913b79fae08ebd1ec185821e128e107c4ac26341535c05f2"
      "8e3ce69d6e2d45e682452fa57bda5468fd048f90abc8f1de9402745bd427816b03a23868"
      "ff10b5103eb5786ca298999013eb9aa6a23cffa9c15470104cc72ae9b31347b4e8b85734"
      "f18088d0beac4b817d1700bb7417e0e227ebdc5c7ed2d6413981eb9f0193144f7c28e88c"
      "be7ffc7479f33422821077b6098e8de2f35228739f6e62b81308c884d44f5c2f93eb9b1d"
      "de241d25b1fc6081596f4da74c7d669e506c06541830d480163ddcbde0affb634ea8eabe"
      "1b976dd83595c3c4f447d20d8dcb9261831cbddba5879b2a2a6fb0c541e8430c295908c2"
      "f45adeb97a76cc0f8d49a5e01d3cd3789be35cbad5dff5969ab3fd8196f10eecb1c27fce"
      "d37fc1f9346912f2f8b37d8619b05b18ae6ea14911efac21efeaa37dd27b4e33699b8f4c"
      "48547b238009aa2e378e8bf8199ffd24a85aa90868c83d562ecf9f7769b289a0dcef829e"
      "e8afcb914ca155bdbf7b24d6ee6c2b7ef9965984c337bae5b30b7ef94249925b5022",
      ToHex(authorized_state->GetRawTxBytes().value()));
}

// https://blockexplorer.one/zcash/testnet/tx/496dfffff625ada462cbc8a733f305fdef1ca584ceb8e7efa5e28e38249b466e
TEST(OrchardBundleManagerTest, NoOutputs) {
  OrchardBundleManager::OverrideRandomSeedForTesting(3345661u);

  OrchardSpendsBundle spends_bundle;
  EXPECT_TRUE(PrefixedHexStringToFixed(
      "0xd9afda03ff892680ea6da2268c5b7e26d92c7f0c1855c46052"
      "a2d50c07b5f821e9d54f"
      "9a966097f8593e72b5b969fc3ecf9b5a18b0bf2994318a2f3705"
      "4a3f376d37288111d4fe"
      "53d6ff9862f7da5f87ff2a67e9d601ab5f8414c25ac1f4ec04",
      spends_bundle.fvk));
  EXPECT_TRUE(PrefixedHexStringToFixed(
      "0x3de2356702a83e1a9b2c701e1005714b89d79d75e69b6e36e3f966c8c3f0c584",
      spends_bundle.sk));

  {
    OrchardInput input;
    input.note.amount = 119940000u;
    EXPECT_TRUE(PrefixedHexStringToFixed(
        "0xc140e946097edb3cc19d0b341569c29882ca9c6e2ca54b7e0fc31eb41691f007830b"
        "5f240f0f02d7cac925",
        input.note.addr));
    EXPECT_TRUE(PrefixedHexStringToFixed(
        "0xac6558a2ad37288a9810f742979a8861c61b9bd40028835b7d627c16aa8f5f1a",
        input.note.nullifier));
    EXPECT_TRUE(PrefixedHexStringToFixed(
        "0x8636f0a41dab6e82c23c7277de1fbcf7d69acb0cce21ffd29a08e20d851de63d",
        input.note.rho));
    EXPECT_TRUE(PrefixedHexStringToFixed(
        "0xa4dc650000000000a5dc650000000000a6dc650000000000a7dc650000000000",
        input.note.seed));
    input.note.block_id = 3667204u;
    input.note.orchard_commitment_tree_position = 114568u;
    input.witness = OrchardNoteWitness();

    input.witness->position = 114568u;

    AppendMerklePath(
        input.witness.value(),
        "0xe88e31b74c5aab7239c8c295e6b328867a3d667df49674650f6c4f1c8af32633");
    AppendMerklePath(
        input.witness.value(),
        "0x28ab95cac6eb122baaafeb8e0b62a522cead6cfbb4a9084a18da9cff3deba907");
    AppendMerklePath(
        input.witness.value(),
        "0x3a616fd4ac02550675b5ac447c6fd81d82295189f077d5b8a42c1b3284e31238");
    AppendMerklePath(
        input.witness.value(),
        "0x528d4da55b7a5915d3d6605862747a92a0bb64d7bf69cbcd1f1dbf654eb56d29");
    AppendMerklePath(
        input.witness.value(),
        "0x0c6afaa96051f238c54cf96530fcbc58350261d267f1d9b81aae71fcc755233f");
    AppendMerklePath(
        input.witness.value(),
        "0x66251872e1396873d34b28daa4a3db01e965e88dbf7625f8e5be49f03d72000d");
    AppendMerklePath(
        input.witness.value(),
        "0x2f6763638bcdf76109c2210145af7aa1505cc68c2cc53ee18d2cb2bf6d0e7a2c");
    AppendMerklePath(
        input.witness.value(),
        "0x86c7a8020a25e94fa40b606eab684131bd9a9593f6f27b615cdd55e56b423d18");
    AppendMerklePath(
        input.witness.value(),
        "0xff003576721efedc9ec62db4bcba91fc1a0738b18cac5c15eb316f77c5243826");
    AppendMerklePath(
        input.witness.value(),
        "0x9e1bfb94f5dc4b7c15092ad23d89c4e3f197db541f54b3587f404c1d4d981b0a");
    AppendMerklePath(
        input.witness.value(),
        "0xbaddc63339bcecc8faed385b6f16576c6378d9cae9ec60974265b4afc1781f05");
    AppendMerklePath(
        input.witness.value(),
        "0x73ae007fce7670a9f40639ef998b23b8e8b7990c9894b13de595d7592f32c223");
    AppendMerklePath(
        input.witness.value(),
        "0x622c7605d17857460d412e4fff3265e15416029f607b7a5daaf2511a40201511");
    AppendMerklePath(
        input.witness.value(),
        "0x067fc882d2ebfdf7969fc02814cbe49dda32e267e963a0e79fad8eb7e0694b04");
    AppendMerklePath(
        input.witness.value(),
        "0xcffafe362f37b0b0cc76e9f0428d4d099ef6215803e76dcdd16788b155735f21");
    AppendMerklePath(
        input.witness.value(),
        "0x7f93215cf466b333690a951c86254d6729672189dc06160f378267efb70b580a");
    AppendMerklePath(
        input.witness.value(),
        "0x25934a8c8cde7b4ba7e51d78f2321c7e286d140811a192f692f29d3f0ecce510");
    AppendMerklePath(
        input.witness.value(),
        "0xbd9dc0681918a3f3f9cd1f9e06aa1ad68927da63acc13b92a2578b2738a6d331");
    AppendMerklePath(
        input.witness.value(),
        "0xca2ced953b7fb95e3ba986333da9e69cd355223c929731094b6c2174c7638d2e");
    AppendMerklePath(
        input.witness.value(),
        "0x55354b96b56f9e45aae1e0094d71ee248dabf668117778bdc3c19ca5331a4e1a");
    AppendMerklePath(
        input.witness.value(),
        "0x7097b04c2aa045a0deffcaca41c5ac92e694466578f5909e72bb78d33310f705");
    AppendMerklePath(
        input.witness.value(),
        "0xe81d6821ff813bd410867a3f22e8e5cb7ac5599a610af5c354eb392877362e01");
    AppendMerklePath(
        input.witness.value(),
        "0x157de8567f7c4996b8c4fdc94938fd808c3b2a5ccb79d1a63858adaa9a6dd824");
    AppendMerklePath(
        input.witness.value(),
        "0xfe1fce51cd6120c12c124695c4f98b275918fceae6eb209873ed73fe73775d0b");
    AppendMerklePath(
        input.witness.value(),
        "0x1f91982912012669f74d0cfa1030ff37b152324e5b8346b3335a0aaeb63a0a2d");
    AppendMerklePath(
        input.witness.value(),
        "0x5dec15f52af17da3931396183cbbbfbea7ed950714540aec06c645c754975522");
    AppendMerklePath(
        input.witness.value(),
        "0xe8ae2ad91d463bab75ee941d33cc5817b613c63cda943a4c07f600591b088a25");
    AppendMerklePath(
        input.witness.value(),
        "0xd53fdee371cef596766823f4a518a583b1158243afe89700f0da76da46d0060f");
    AppendMerklePath(
        input.witness.value(),
        "0x15d2444cefe7914c9a61e829c730eceb216288fee825f6b3b6298f6f6b6bd62e");
    AppendMerklePath(
        input.witness.value(),
        "0x4c57a617a0aa10ea7a83aa6b6b0ed685b6a3d9e5b8fd14f56cdc18021b12253f");
    AppendMerklePath(
        input.witness.value(),
        "0x3fd4915c19bd831a7920be55d969b2ac23359e2559da77de2373f06ca014ba27");
    AppendMerklePath(
        input.witness.value(),
        "0x87d063cd07ee4944222b7762840eb94c688bec743fa8bdf7715c8fe29f104c2a");

    spends_bundle.inputs.push_back(std::move(input));
  }

  auto state_tree_bytes = PrefixedHexStringToBytes(
      "0x0114ca9cb755b3cf0b816c679d3b044d7ce66e798fd69e3b498d44a298b7750b100108"
      "77046b49f3ff298e46b64525479c5f0ba91e96624bb0e37f6eca24bc08062f1f014c3b44"
      "98565b8f0507acdc5986f78eb4148a9960a82eca797f911b182a14871e0001dbe5daef0f"
      "2d55f70ce86d3d93cf44e996d9ae40031def439dd1d19477a80f040001b7030e5df89140"
      "06271d96fb971850baff628422210300a465651ae8d37ede1a0000000000000000014327"
      "5cd7061891f321cdeaebcb38811ed37d02d490e475ddcd9c3b6e6f721003017f93215cf4"
      "66b333690a951c86254d6729672189dc06160f378267efb70b580a0125934a8c8cde7b4b"
      "a7e51d78f2321c7e286d140811a192f692f29d3f0ecce510000000000000000000000000"
      "000000");
  auto orchard_bundle_manager = OrchardBundleManager::Create(
      state_tree_bytes.value(), std::move(spends_bundle),
      std::vector<OrchardOutput>());
  EXPECT_TRUE(orchard_bundle_manager);

  std::array<uint8_t, 32> sighash;
  EXPECT_TRUE(
      PrefixedHexStringToFixed("0xd3e77b18c34129e4ec1e30bc4b8d29d16"
                               "b7163ab5829730d8af3f41edc99721c",
                               sighash));
  auto orchard_raw_part =
      orchard_bundle_manager->ApplySignature(sighash)->GetRawTxBytes();

  EXPECT_EQ(
      ToHex(orchard_raw_part.value()),
      "0x024d334dffb181c19820af63fe002156426e00ee46be26df91b11c951d6f6e299fb118"
      "574930bdff1ed41181fd327078d7c251d4858affd97c1896d3f626c44b1168f94c92b1bc"
      "28a3802de2537a9c3c1283d7d57495cdfc940e3a4fe5c9b64d3aed64436add5af6f3345a"
      "1856c6b6e0ec764f772cfc01f3f54693749b2413d3312b3c90fe5243bb1dccf94552c883"
      "4baeb8067c8c356548bf01c4d71cf0e8878c9dc657bb231950f836c18ec825d4f925d06c"
      "eb79a748546cc7fb807b1fe049664f44a83200e443ac28228472177079176200207629c6"
      "91065f9fbb670bd9e991b31d7060d27c291acf5c5ce1d8b56e51d0f3bc734111bf66682d"
      "6456ce2bccfe7e578b71f77f04ed5016f20c67220e27562c50a3154555123246ec79d64c"
      "b4a6b56c48d8ae5a4a34f4b4155070a9174c3591847ce69f7e126407dd2d0c72d8f9391b"
      "1d8b86d1bf4dc3c0924ffc8c472e893dd9df81d6dab2eddd915e10b4e102456ba8df0a87"
      "e1a6c9543967f50742706f4946735a20fde512d1d8beb4525e185a29a69ab64dd35c6673"
      "d5e7597e7a3d3897006778fa5607dc348da9a05824d6d33eb6b97d2d9f37c25b8eed6499"
      "d8a17f13a3344ed815258651f42990fbf436ffa5c33981d4d106e9808918491e9252f527"
      "e8fdfef2a6db333f11396506f55612cd1d01ec2ca3c815e783ca3c93599aa4d38519da38"
      "af4f0e7cae062289e8201c64e127f1250bf7f0caf74547c0f6c4c2258ad09715370f1b3d"
      "f841d8b40206d508bd98a37a4f77672acb2e17b16e0b61c763c22fc5006234c8ec97d234"
      "8fe5f600bc87b37ad903e3499eb8ccf742dd8286b36a2e648f5bb98b71c22dccc0beb631"
      "d20cca6f72ac0a8d0314c0d50655683a4d303feffc9e71b970bf9834956baa6c7305e09d"
      "cef3f914c1ef03d175cc3c44028587e30fed178054ccc96623e52190e6eba85078015701"
      "4a4a258e997ee308d937b502d495c3ffc9c2d031685aafab0b4b3734cdb39e2ff46f182a"
      "03492e6bb17fe16f0c1b19876c69151ea446c7926b18041bd39aebdb7c96051f0756eb9d"
      "f7eed395a2a48d2f22c1db57d541f0040aa7b0bdcb1523d73b146578bb46153726a9c684"
      "6f34006e2a2b51b00a15da42f5e4227d9d1f83057c30b76601165253e199bc029d754330"
      "ee70b18981e74977282b697e6cd0b1c3469d1afdcf457b9d670fac6558a2ad37288a9810"
      "f742979a8861c61b9bd40028835b7d627c16aa8f5f1a99dd9ea24d94340b6f277711221f"
      "75f0e616c26c2c94b5a1f8258608e2f2d22c8e17d6f3aa6e110002038c1e5f975c057a36"
      "aae84127078cea0552d04b0e23248fd2bbe26fbce587c1c66e646b620c9bd6b31fcf09a6"
      "c9ee54d233933b04042b8ed5b3e14ed9c7a44309197c28acf823268147d963d07bd89968"
      "b0ea9a2a7d0068dcee90af0e86ee7440c89328a4e534285aaa44756ca9624b3ec982d958"
      "7caf38d5c8f6eed5c0ce37368d3692f3a9019855d7b910af9cc629b4fc74124034f64da4"
      "e2cd74074c8da88e6e30c0fc200e483578f00cd713bd074d970662ad4aac5eb6a573a656"
      "91946795a8318ff03cb13e3724dd2e8e08c81dae4bbc3390f279b4a898528999ce936d20"
      "6427fb09544dce3b6dc145b9e39a9d7b1b12299e1b77a847ea64e0373837befaf07e95b7"
      "23bf7978a59a428dac8703f452a45dfb2434e790f620291f81cda6e1208eea4cd36d66bc"
      "9ed745017b489c77887c4788fa7c202b8e243106d62c9090415d239d821cbd01365c4e36"
      "11e9026d2228cce8c13479a88ad1dab5892e6735fd2d5062ddf2352d41fb691cd7a14b81"
      "98990134a9d7b3aba0a1e9bee623edfa162efb5ad945292e008c94cd19741fa2e30d2ba9"
      "03778321474ab92292292169d4c03079f3c02b7b43b3f67400a70b3d86302045e9153812"
      "7af6d7cd7787fc033ba0b5da83f984d8fd680ed6eeb45dafbc192d4e93f4050546512210"
      "ab1dc228f3e54c93afa23f89f9c2e66faee435698d1b5ed2f7d66b0bbc6e13dec496c6f3"
      "c42bd6489edae4e36193f78fb0e10076b6fcb7699fe8f2772540d7dafabf211efb374800"
      "fe9c00866fd2ad687691d53584aebb1588328562ccb5df36756e89e8129d1a2d5d2df962"
      "ad28deb48b0616e6f90f5c1b34411fa1bb86b6714cfa74e3fcae1dedb20d775fe23d4170"
      "f61e8a822edfee855ec259e6c61bdaf6fac33452bf224a4b2b42c0230cba21def8e110aa"
      "1674ae4e7068a01689e17125c369ee4142e143cf04ab2029eecd5d36f89d184f130892d8"
      "8d9ff2456fcda08af89459e338f5b4107752b65e199b03a023260700000000923c4a7c79"
      "f105f042a3baf287e4458ac599ef1b5ba2edb2d477b8d1c0a66c1efd601c3d8bcc27adfc"
      "228f7967cd0ba527f438ef011a4f31c058b57aaf2d3d20c50091e4571a128c3f049b5a79"
      "d74c3ffbbb327732a6e694ac415fd778486be1c34f24eddb26644520a860329385bbc61f"
      "ef55affd92c096cb8d99702743c3b9fce2b210c583f23ac78b3f2498b15e564d620fe662"
      "d409189c840f955943d34eefb69325cc3e718059d4366be086e702aa018a3548df68c860"
      "9a76c4c323fb742c5300ec0383821d03b97cce1808d175e07de93e85748d310d6687c545"
      "cbad0475b93be6d6484ade5b15361039257b64176d215d6e2b60914f7cb86ddafde88195"
      "839bb022a4fecfda6dc88a79ba99c3571ccab18ed231203c08fe35285aea32c2c6a6e9e3"
      "428d4ac06e835fb8ffff4f201cf87d1f563dc607029b92379a5dd22a1a3c24742dadf44b"
      "75a207e7b28279221672606c539a6ef9ebcc833e809bc75aaeacff0276ef5933950addd3"
      "176d87fba83f58caa73df8aceec9dbd8af70d8f06f826b787fcc4b1692a4f731a4c3eac5"
      "741c28ab6271b4cf6ed3cecf50234a5cf00743f9481529526e0a1680ea2d38f08ddcddb1"
      "9f639be985900691a2b95c18ce2aae7c20ca780a49c1142d7e7560782976c38ee0b3ebf4"
      "8b4594ea8bd6db7fb91425ab8de6ea3d325c77e985ac3c24898f3f3296dd7f286c83b13c"
      "6950b39aa29dfd68a306ce3135721499e06bc6908e2680f5f4dc63953c39ae135b58e090"
      "e986af82126cf283c1a0a64971e875eb970ab10c4f2444f081b6226a502e789e0e983013"
      "70fcfb17614be01c516ddbffaca937fb6c3f6e4ffa7c28a339250e33d3b88ebbc18cb526"
      "bc881d51ae01683cbddb4b23b99b39714365bd40af757c428b2950ad94794ff87545ef5e"
      "08ba363634464aa173d6b26cc59212e67d748b5e558f3347c0f344dfda55d757b25b3bb4"
      "bc093e94bc655374faa0143a30ea9601eda5b82eab1b9e818c04f2512834830ba4e0d5a0"
      "a04a9b2d84ec24aed57bf55fe4af254515714455d2a6f7bb027d923b68a6858cbc6b6d4c"
      "7242eb290c150b1bbea6067b529ad295b83f9ca690065b1976c46b023de849bb135e593d"
      "0c8c76a9bf93331b4b1105558647830b0b8b37af96f9b2283ee4bb7d0a5a2008a4748400"
      "ba8cf880fb51bbae04188c73ab1af3718deb67bf5ade016121fee140654319049e310be5"
      "e7f8ef3e8c57b7e013b770dc3b03e5176a28f76114120d33fd1dd5c550806be336f58606"
      "23ff4c218f1f31751238aa23afb91f594473395461add6efae9cfa0398c82c25fa355316"
      "18c42beab9e5f512dbefc0cb5ac528dbc218e2927781d3ba7cf994742d8dddae36968169"
      "8b6a91b34e8c9168baf81ec549762424bcb3a150300916762b772e535abdede1c5aa8ca7"
      "407abc8bf7d5f5d9487c41f637be7a8439f331b8d5b5fdd096320d7610587b1b438a4524"
      "3042cb25ecc1da587dbf56da09941cb332fb69c7768717eee5626b06894a874fd4beae39"
      "e475585b41acbf8c40d46ef3e4ba7390603a8b59874e24891eb17400750a5a87dc79d7f2"
      "021de7077f3c6d0f4e66c5e3cb47c9f4d8603c72f8c3966d9b2fbd810d20091ba313684a"
      "5f0d8217b6c83557bb66269fa1fe702c52147c501580fbc142d5bd64ae301e091f121d73"
      "bdf676f7d89a3fd34edb463f1618a592d5aeb29651c9125f2dbb355977da88f8c0ccb6e9"
      "953388b7ca66665f670befdaa29454662dc5efedb6bb3bca5bfc4a874da14e1e9fb275fb"
      "a069a1664698463ba7ceea9de87bca4b910709cd980d9c4caed9cd936fa96acc3efab382"
      "7cc7adfc49c9a529bb82c059449f8ee72cb4ebb1121f76e96045485eb0bd06a719d53411"
      "2901f12dde5cb571462a30bc4e6810bab9b602f17c320533319b0cd18ed51190bf63baa2"
      "0a7df7e9f63c73a3bb32fca624fd1cb83f7d46b779513000c5592c1668ef49eb43829d1c"
      "fe2b368af2f850d5bda4aed7ffa60531c480495a2e134de956ef304dfc3416a4aa1d80bb"
      "4c8bc80791eb9e4de288d6959e3eff9ba03b4696c7970857de3fdb9b5a98824992eff548"
      "35277a4517392794918440cbe0156e6b9facd8c8b748f20e840c4493eac4224ea2772df6"
      "ba67f3c93fad28922c22f30eaec4bb12ed62eb515029618df6abf92d4bb6ec572bf5c3c1"
      "b382961c1f3fb4b4537bb9d1cc401e56443a5c0027940eb3b05eaeafbf4b024a9d7791ba"
      "24b43a1729e577c5f1539ef7990268d405100aee84f0cd3a9792df29ab8f825a13c7e86e"
      "ff6865ce03913110ab00c62fdffeb26c2f007a76857ffe7961777be880708ba0ea9b2672"
      "e0bcbeb60e22b706a1fb9000aedf47b75a0508f05fa6e997bd1e1b69aadc182172fbcf34"
      "f628726ee0670b91a42e722f8c7b7321e256fa86b76c1aa7d003746de50ab5a86e8c9b52"
      "ca80014d747907a60bfe54b7805bd11ab0f68837fcb854e04fcf04d6f32db15f5c75a3d8"
      "78d5a8b9c6268386adfb1cdec8992e70e3750132ce2f3a22a938fe2160932720981bd6d8"
      "3264a9f8d1c583897e96336359b62aefc5b25466470bbe3aa9c808e93e7b97c06094ada4"
      "9514002ea2878266787b2bd1efacca9b820bae178328434f821e92a2da8f7be810e1d95b"
      "63aa7259903b04d36cc12629fb0221f9d695b30b8c97414012a92f0f6cd33aebe920f0c0"
      "7b5f9f75a68bdf3d8826e9eea8610f73e8d0ff1f05913643122e4cb80349b173888fb52d"
      "878ef5c1a30efa60e7f7c406cf1682e62b259922ad0ac4b359c88a2190e50e698d714b1f"
      "553e9bb0f1d596c0a29a4f716b6442f34da7da0f5c8d2333477bae1099c8fcc36b141fe3"
      "15f283d3285729ea9d0a8eb56b0704818e509414eb4b5e2a3c0c7e4fea397706375251b8"
      "ed86f508b2fe2e413b3e8770660ed1edc856ce217105bb0a4b2cfc67374cf31004cbb676"
      "f5274c0d5f9beb77d528ea130f69fc73e6821b00da29bb61a65cd3f408984ba973f999f7"
      "2d552751a74a02a0262d3201047c81c04024a400ffc89fda6f67269351f811f1a4ddf7f5"
      "fe42c81ec72439ef1eb65b814e2da05058968919f9814e8fd7a21a67535d6e30801e439a"
      "569fefdd682c4763882d674526b8fe93c3a63ae05357721df3e4528e8b5425919b13f1a7"
      "d14a93e93c26006b82f9a7e279030eae41a9751cdd1bc986635bb234b60b97a9f898838c"
      "5c0584122c3969471ddc6da70093d23c0445a8a6397cd1cdda7b8141397e20b49b3ca9ea"
      "15702a701e8608b283f4ce3bf90f1fa9eac7c1800aa03756c26f1858252846e759af7dd5"
      "3b6fc72c70fc2e987322c16021ea99c3301fa0744aa58058e814153a49ff247a144ee70f"
      "55219c4a6ca0c60e2db788f4bc86524a81c5a06ee5208c57416843b6e2caf5dd99ece832"
      "87b14aaff6aa3447506a5319fc3f09bb260c7d01b2046ec80b8b2d1cd8468e33d3857b3a"
      "62087fc3572ece1273b24eb01630ca70935a92774938455d2835105c0179f1b11d9c9e67"
      "7dc4663f985afa10ab19d232c538f05e69208463acda41f104fb482a4dced74c6334b5bf"
      "c7b007cc4f04128b72a5bde9e78a6d22c0de3ba6a6d4d4dcfa3fe8b1a2e909fbf601b38a"
      "25398aeb3a8e99da9a75c2b69b48a39a95d14e5c123630791fd66f5d8dea9127220e4921"
      "a7370cdcfe9900ff33b3a98176978ab92bd096aa1484e81023c9dd67bb3414a6746ab7a8"
      "a881f05323561c4f450cd5b3088de7e73266e035683fe2f6b52d83aff12402950be6dfbe"
      "706013d4cefd7afb6ae703a0c63c8a4f2a178762a72d0ae0460e5070133be1c624d4d33f"
      "882b99e971fc126b0588fec704c1e345fe34d021a468f30f6511c3a221adc8792751325c"
      "7feffe5917ea589d832910a38f27411ad2cb7f6984adcad4f941fa124d673f2d5caafcab"
      "3e9efc6f94ba6d4c75079069a793abb091553cd65a746147eb22a35797068625395f3fad"
      "5d4fb5e71130a3b6da07fb628dfa31db0ef3060f06ee9f9dc9ced4318d9687c4ff155bf2"
      "5912a818cfe073e7c193b68efad7d9bf29e1003ae738ef35f202a6307e4fb3651b062aba"
      "fd56be5720ed464c162d1d950211396e5527f882c8296fc687f6d5d09a0ba60b8f3a9e88"
      "1a1ea77d6e8daadba03588048ac22a0d7a04edb1f4cede3b0f27943847a71f4fb6f85a3c"
      "f28acc7e9ba5f09518759fb0ff9dbc148a4f39da691207036cfff29470a115aed5a7a360"
      "7a6a8916a4eed73edc940f52e0eaccd39f39523be86c8c5fc0634f59878e9200b73e3ae3"
      "bb144270ce7ee49c40e48c04c00faecffa8cf718d3594c49850fbd5da524fdf41a07c077"
      "f922adc2bcc57d5b522c06e7738918c0137221a37a95386a485de5fd2defa99c6fdf3ac5"
      "df965076c307fbc3a3550ed593ae359962079ba41e0e7f58d79c717cf218200cc26c74f6"
      "873f419accc5c3b0fa4f54a281fbec96fbe6ad84c6e0a9b561c4e067e98575c656225a68"
      "cf48a5b8162a2b8fd72164d20a3d75f3434864c89a58a46d57e6ea92db2e23d193d7e20c"
      "68f322a874e149d080b17a2f06d963b00bc81e56070ed206dd0681164d7b16d72145b720"
      "b712069856bbe4f3df880b3a7439f2b8b95d753dee10452bde9528ddf9cfc731df4850bb"
      "59129df94779975bfc2fd9cae43b96a19707b4e6b8eebbd7b51ebea29000eb90d030c716"
      "144c38da89dfcfae4dca98d726081a103fb8f5b0ee6c9653ce4342ff2c4b45a71c8808df"
      "87956ab1ce58702c330a89a317c9a5def9b2976b41868a2de254b969ca9290658da18b5a"
      "c04c2701400a886fb038e1924c9c97a7f07961d648533e08f80d521428b8d96cf8281a03"
      "8a187253ff9622cb458bb8a630e1577aabdee2f72f7a9328ca2d889b0b5abb4294047043"
      "9b2fb9170b0fd5a14582937b3714d8670b9e6064c1eb42a2a1bebe58a236813794f71fd8"
      "5479be91d2deb51988a207be3face62a1376233b7d4ca56f5c2175a2df32a3752dc52452"
      "15a05d19b759a438d930e4f31695332e52cec95e823d12920b90dda98e64f081d91433ac"
      "2ad0e78b9f933c92e30b561ca97b0dfbb43ddc8420bfd7a5ab9e7956e1b5430ecd9e2d51"
      "18602c5b4fb9c8a2932abb0d7317117a7aa5d298dace696763cf4a8252fe3657a723221a"
      "518c2c47b7b9e39e21004d2099271282d42e7ef273e769914533058029137457caa86a05"
      "17f57f15772b5a7a8071b1a7d31fcece16d0fe26dbfb1a5137c33dc68112e2364d91f595"
      "3e31c496473d45fa37f1d2762fd708c5c2be0ae12383bcb196757b79ea88ae523c3038bd"
      "842f22084a4e6712eadb1f1e63e8744bb9fa0b8517c319a5895bdfda9d38e57ab1dd2d71"
      "8918fb969154b0929de49ee2cf89f0fcb32f5743b952053094076266c3435b404de9f4d3"
      "16d9240a8dcb56fb9184dcbe6e2c3f91738286b3173851574d0378a9ffc08866a6e9b81e"
      "409f8cf2444c46f703e06f7bb209d35a731b952d05e00f3b69bb5ca72c0fa03daf3f21b5"
      "812c1cf013f85f9b3b682dd9b13d45176bd4cf7490d22911616ff0ded3ea522495893455"
      "5ca61d48af97eee2341aed401c8d51466f8cbfcd7d9d8db33d6082a7152b99fb19c2f2c1"
      "971d9cda3d2ac24d8f1fae25afa44f673682543f4ada880b081ec988a9f0c4a7875fec25"
      "8431252adbef3e6d1aa2a4bca9fa73c43b5354c507f2cd35533327dfeaf677729336e2f3"
      "adc5089d1a6d2cb1507ce1b4a7dc42028d9d58637ad028a77f037b34f11b4bb0b4683ec2"
      "466d25bfdb3d878b8ec4518a9e95cf3788c16b7bc9d1094aa4286fb68a2b9d0af6f4d3a5"
      "407990aa6c662b1a64d0857c269aebb969e9be04d11cf776c9f9b2f1c642fa8c26c4acd4"
      "9df1e608994a1af5ff83170166e88307d61bf16daeeb0ae15dcefe31b584b46c92dc8523"
      "6e2562f4128c64b8ef98c1c72d2bdb4099fa2619a0c210ecf9724fffaf589e5ad871ddc8"
      "24fdce564fa9c2bd491dc96a92f1c2802f6183692b17e34dc9ae0846f07961f267ed0577"
      "2ff7417ce43f41cc023617ae5ba68a656382e6a7d2501af9972448c3e6493cf6ce749fa4"
      "cb25e6c630389a495a062060a1911ce34e9d17138d15821f5a8eeef46bc6f91f20205730"
      "abfa28f8fadb23273b8e55e85a2687c84e9784cbea5b72b899a683336f24b99ea2b9aec0"
      "57102e0e827ec37c9b7bc15a27cafe0b2d11a0560f93b8e0d10a746dda545b28e9bb012c"
      "55b6e26909dd962e496c8f0f09a1df2a396b9f960b07f4da828774860be12d50d3063b63"
      "d10f2afcb6c947d0d069dbc78e55341aa3389f61ab888b902d105b6d2f75b731f9517d4e"
      "9c5e55fa3ff1ee2be47fc1abb0108116c66567a8bd6f1961287b7272a41521ff39d5f4a5"
      "f18d10d51a8fb8c84a0e0baf1798211582080b4188f2ce54b534f2c8e854857486e7e189"
      "5996f19ae12d1a676d98d7684e84896416f86e47ea45f32d1a86d8bbc8c90200b5550967"
      "f92bb62823fcf69e9fb3fdffca206f4a168398d8c3c623fd0a517c86c77fc1d0600ffdad"
      "6a857ee0656b8abf094b0b246bc62594ec22045b0392f70b82184bbedd36953b553f2a12"
      "d1cad48af1d1f34183913b2f483dd785210e175d37353193450c98d991703a8479f59a62"
      "fb30a6a1d5aa8bfc62023a7b24475f4e4f7633e25c39455b9c138388aaac32adc5121ab0"
      "fa5404dcf2e3dd3d721405dcccf75ecedf0eecffd50b6a48d9e519ef9673043649e878b6"
      "11644ce1479d34d3c26d803145364a193e5fcde7723bf9c53287a4b139399317b2119ce0"
      "b369380bec364ae5e9108b5b55d1f15b20b65abd7237a56d1d85ce8deaee8019365c1fcd"
      "64ba1273112797041fc5ab4629ee2d78ba71a0446d32905b20e781142bf47ebed5cec19a"
      "4f198b5594bc4606b073fe048022215ddb85824fe63fef043791f78b0d7c7a883e1caae7"
      "40bfe885f2c6178ddd1b2cb13bfa3ca2e28416c10b65a3f56806ddc720027654dfac740b"
      "9612323b1f2c3102d8c4c9339fa3c011936eca68c058eaaa8506c1d676239ab465c4fc80"
      "06a1068823b6362f1912a356db5cc84624a1e3d4780853ceaf0149ea8e789df733f221d5"
      "b8a6ce9e1aefd1e5aef5861184580834b11e1e63977c8d1d226f3d64430911e7fe28129b"
      "86d6067db5baf031190a3297e130eb24a984e3ec12260be36297783f098302db79ea50cd"
      "635c6cf87cb5e0493f29d2a42fda1f975c5f48847d889fe9451a5bb84f75f2ccc757e206"
      "acba2531ee015c987f81a45943df791d715a3e3e79b099ceda1e9d90e7514588a44438d5"
      "b62c7b6d8b6450d1182fbc69cd246e2ead35ec67a35a63f1acd41e512b573fc51e0c42bb"
      "42797ffcca334f296e9285151b13cee5b08da8900ccd544ba01ebc7f131f91c6bbd6b1e0"
      "1d13c9e71987ba75a55e5cb07a7e4938b94bf5a224aa9eb3df0a2a91579a6194dd51cbb4"
      "51e7fbf641ce8147315f84f1306c5cd7715b13b7c41cb18936c2e4a14dfbaa1e39828096"
      "60ad26020cd420a05df527456cd2ed34401400ff8b739214b4c5312b7205de054f03f24c"
      "a7e65e8262f7830d57ac9b302a1311f7eaacb1ab643e3aed3779faa27eeb437bc3ddef92"
      "a0df9bcf774ff2ee2001770bef56a9c6c13808b3ff84ad7975bcbb0f4ec63c47f1982250"
      "f9fb07c45e1ddf10da92872759063d459edfe22f8d38e6828afb19799e7e6e00a6f924e4"
      "332e0e3670e97f75e4a44c5db2fe75bcff8a6b4a17e582423acae06b8472b26c2821d4b2"
      "976107441162812ce4a96d7589cdac6e8a0c70674a0d65b2ee9f03a11c1edddf4bbdf889"
      "1be6e6032b97c73ddff9c786d81bf15fc357b62e8eacedfba22c31e81cb351595365573a"
      "1a79c143f2650cf91374eb1aa4b564535a31c7fcd30d74dbc8083eee4ce1aac0247a7513"
      "759179c43fb3b38bf93d6eb726d457c7ec10a4d51c6c9c6f98ed569da4ab08d2c31e0df9"
      "42604d8ee6f19d3dba887074a93caffbe94b94783bc88e0221d67b722207e2bc4482c823"
      "7a497161cd29fe9c4f09cd868412eac13f0b25d8a698a5ddad22aa531f14e753aa9e1abe"
      "e8cba8ca4912c0a9cc3276cefcc7aa2092615fd50836a51f7cc93e636287099385001558"
      "4e1c96c95910e832caaf9d63747e43682d14ecdd4ebc75527a850e8e93908f016720a6ba"
      "2098e4fa8e32509a664be2c3883686825d6eaadd3b1cd199e3e277cd333d8325ee83ef71"
      "9a6e971c0e63afd3f743785fcd6d467fcbcbbd5684d565fb543431278eb9d72ce8121e4e"
      "02b78b69c07019b2b94b535f482d890a32bbaf0179061ba0b480a65cb71f14f6a573636e"
      "3a738201680263079e030a669813cfdaf4264d66307a3c4347a23cfaa9dbd98424b39067"
      "287d0c7a1758352108f3b0397d23c7ec5415a36fe44062f90cd0f18fb9b0eb726ba10512"
      "6468af52ef599c2b1416ccee6792a9714f7a0a2a8d54bb7f10b68450ed8f7891762edaa1"
      "e41426194b1f6ab29672a7e32d11bc94d09b425f5aec143c80e5a444f90a49bf02f6c2d9"
      "8b21bfb916204db9c07ce4ed751b40474465e54ea36eea5b11e547710b29b430551b4b17"
      "16c451a341b26c7c253170b587afd5b197cb7dcefcb8b58f04db73ed6610fd19c5a9ba99"
      "440cc1e0d110fc185a140b74c6c6e4d64f4eb65c7513c5d1fb1b8eeded1c02cea7272602"
      "fb23c762f5008314dd729b946e5e9c24628d2cc82939be8d63b5b85bae3444c0a4a237a6"
      "5dc7f290d32899b907b2753b0c9e0c5d811f080bbbf8dac3b888c8322d90b5c3d313c93f"
      "929cd072ef19234f209d20663d27ea637f8ee80226554c3cbe70b6bb4ab2ddd251eebbbb"
      "a3b771ddedaf2c1d250e072b93559900051ae7aecfecffb208cf34fdfd11e2a61a940e92"
      "c03a53721e062e27b18ae25a5c3acced8c1badc2941d81ce69ddb04bcb78a2d51b09ea65"
      "042df1b44078da903e72adbf50b55a520504e2d43096c0c109767b12b53eb38c6ba5a837"
      "92fb7e4acf8f92e422d8750d1101e232d960d9f6f4c9f0744abd0786c533b17420f5db0f"
      "16a73be404f2e048fe35bd135a8da6ca466f0c2fa3fcf8fd8e030650b05419df390fbd0c"
      "cd3f29f0063194031a93a20329fe6c14fbd70cb8d219985067222a3252bbba47e7df9a1d"
      "b2a5d356e6691dac0ebdbe64c6cd5a3a4d3ecba93a920877bad981d832ff4bde364f243c"
      "99ecc861f3d4f1374775497bbe02de9c282b89e95d99e53bb0cbc0ffcb8698e895b1ed4b"
      "130095a4a91f9b77aa0f763780a797137e34e28ab677b7f137941d7c3ed256b3a5753ff8"
      "ab367fdcbab517db3d5210739b659950d5ece6aba9e52e8a3ccd499ef4fb58ba66e5f9cb"
      "7a057d02fdbff5e475e4890161081983151774be903eebfabf71705b8fe55434611f7b53"
      "45e61a241e849f29bbe525c9731ffbd0cb962c56add0b36a56aa314aedaa645aec1effe5"
      "6cfdbbff282979d7e4756aabc532505fa4712a661896657b552a4e2665361027b86e76c4"
      "c0df54a5822822fe2ac15a3117e38f56690b64a373a6fa324b899c4df174d94e977aa382"
      "3f365711f96c6066a0060d0fea5c57d1a21efd16e0c06cc7a83cb00c32686f7082f2942e"
      "514ab0e2bbccc3c1bd50e48be6a295400619095d9892c2d954e9602f17f3276fee4877dc"
      "87a6e81bea5bf6e62513776cbea8653efee4b90ba3000fb308e527dec7cd2e46b9ac90b5"
      "71727140ac0178042cae30d12adcfa9b7b382c14e693fdf32d98f853d6afbde6183843d2"
      "922ca59228ad2bb4d5aaf3afe96d43b5ed259a69df7f650927a31916dc40102424b55cbb"
      "7cbb4851450eda80ed2d561b86d00c9eebba4b5f4722e4791548926509ad5583e5a2dfb9"
      "8c1885d93579f55d0f4a9343876a016c726ec2bbf087c064873eef298d83da6e6f289d2e"
      "cb027fc81fcf10c18e2cf614a4717de9a7976ad2ce21f7b7ca7cf982a4ca0719fc690474"
      "f1507bbfc989e3ddf01f940eba4ed29459a19ee065e1d8232cbc072a35b43fde5fa996b5"
      "6e0cd9cb4b2ea9617a03f74b3790f4c25d712b06036b49df33ccbff1c6da43aa64defc78"
      "098af4f2d780f8513d089c8a293adaff282efe2d7e69683f58d67de6587116e3bef96074"
      "006b9a5d9c1250212526ff93bbf3bd0e5a82a43ea4d486e9dd065067d9f87d7ba360c211"
      "a9a8af5a4007205154710cbe271a1f5bbcf4403957f8ac9e7393a7017567236936220455"
      "bff8a41384eb4bb9bcc1f4e8f8cd49d40deaa0d96dfc7e6ca3590a208a0770cfb3af1e54"
      "25ffa65495bc01162d3ec3d9cd443fb529f887694767b399e003034a582d876181eef4d7"
      "0c4a66591418811f12c9b994e8bd2cd1b1677d5fea2fb5a329e0dae6d2f9366211d91f9b"
      "d0ac4deca5addce26821f36b64ba169904b91cc501cc84c7c9389930be08e7fc0907a201"
      "5dc4a8e2003e901850a82cb3142f3c20eccb8a8bc1aef6517022059d22201237ecc69a0c"
      "f8bc097eb886a0b4e298a3f42b638a9855e46a7ccba5467c85c418fc813faa628f77cec6"
      "dd5a000867134159333d18133d93e6409f8644332e412838c326cc8523854d7bbe7adba7"
      "740f3af45d38566f7fcfb6d34b3d9a594d8a647b51657a2b91cedd7f30a54acf882b");
}

}  // namespace brave_wallet
