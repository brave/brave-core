/* Copyright (c) 2024 The Brave Authors. All rights reserved.
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this file,
 * You can obtain one at https://mozilla.org/MPL/2.0/. */

// The code below replaces Ecdsa::Create(kKeyVersion, kKeyPubBytesBase64) by
// Ecdsa::Create(kBraveKeyVersion, kBraveKeyPubBytesBase64) in upstream's
// request_sender.cc.

#include "components/update_client/request_sender.h"

#include "base/base64.h"

namespace {

// If you change the following, then you will likely also need to update
// RequestSenderTest::UsesBraveCUPKey.
constexpr int kBraveKeyVersion = 1;
// Base64 = "MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEMZENJfFz9Jph//JXTejVdn5U+ALz"
//          "NT/Bht/fvkf2hZ5RionWCLzcxmjV3uh0R3MKLfsgI3w7ukou7m8VhkFQSg==";
constexpr auto kBravePublicKey = std::to_array<uint8_t>(
    {0x30, 0x59, 0x30, 0x13, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x02,
     0x01, 0x06, 0x08, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x03, 0x01, 0x07, 0x03,
     0x42, 0x00, 0x04, 0x31, 0x91, 0x0d, 0x25, 0xf1, 0x73, 0xf4, 0x9a, 0x61,
     0xff, 0xf2, 0x57, 0x4d, 0xe8, 0xd5, 0x76, 0x7e, 0x54, 0xf8, 0x02, 0xf3,
     0x35, 0x3f, 0xc1, 0x86, 0xdf, 0xdf, 0xbe, 0x47, 0xf6, 0x85, 0x9e, 0x51,
     0x8a, 0x89, 0xd6, 0x08, 0xbc, 0xdc, 0xc6, 0x68, 0xd5, 0xde, 0xe8, 0x74,
     0x47, 0x73, 0x0a, 0x2d, 0xfb, 0x20, 0x23, 0x7c, 0x3b, 0xba, 0x4a, 0x2e,
     0xee, 0x6f, 0x15, 0x86, 0x41, 0x50, 0x4a});

}  // namespace

#define signer_(KEY_VERSION, PUBLIC_KEY) \
  signer_(kBraveKeyVersion, kBravePublicKey)

#include "src/components/update_client/request_sender.cc"
#undef signer_
