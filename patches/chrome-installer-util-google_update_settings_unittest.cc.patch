diff --git a/chrome/installer/util/google_update_settings_unittest.cc b/chrome/installer/util/google_update_settings_unittest.cc
index 64cc1564eb4ed659cf3fc323d4ea43bb597b76b5..ba48f96dd50711e27f68e69335e6bb13f2841b17 100644
--- a/chrome/installer/util/google_update_settings_unittest.cc
+++ b/chrome/installer/util/google_update_settings_unittest.cc
@@ -215,9 +215,39 @@ TEST_F(GoogleUpdateSettingsTest, UpdateGoogleUpdateApKey) {
 
 TEST_F(GoogleUpdateSettingsTest, UpdateInstallStatusTest) {
   std::unique_ptr<WorkItemList> work_item_list(WorkItem::CreateWorkItemList());
+  // Test incremental install failure
+  ASSERT_TRUE(CreateApKey(work_item_list.get(), L""))
+      << "Failed to create ap key.";
+  GoogleUpdateSettings::UpdateInstallStatus(
+      false, installer::INCREMENTAL_ARCHIVE_TYPE, installer::INSTALL_FAILED);
+  EXPECT_STREQ(ReadApKeyValue().c_str(), L"-full");
+  work_item_list->Rollback();
+
+  work_item_list.reset(WorkItem::CreateWorkItemList());
+  // Test incremental install success
+  ASSERT_TRUE(CreateApKey(work_item_list.get(), L""))
+      << "Failed to create ap key.";
+  GoogleUpdateSettings::UpdateInstallStatus(false,
+                                            installer::INCREMENTAL_ARCHIVE_TYPE,
+                                            installer::FIRST_INSTALL_SUCCESS);
+  EXPECT_STREQ(ReadApKeyValue().c_str(), L"");
+  work_item_list->Rollback();
+
+  work_item_list.reset(WorkItem::CreateWorkItemList());
+  // Test full install failure
+  ASSERT_TRUE(CreateApKey(work_item_list.get(), L"-full"))
+      << "Failed to create ap key.";
+  GoogleUpdateSettings::UpdateInstallStatus(false, installer::FULL_ARCHIVE_TYPE,
+                                            installer::INSTALL_FAILED);
+  EXPECT_STREQ(ReadApKeyValue().c_str(), L"");
+  work_item_list->Rollback();
+
+  work_item_list.reset(WorkItem::CreateWorkItemList());
+  // Test full install success
   ASSERT_TRUE(CreateApKey(work_item_list.get(), L"-full"))
       << "Failed to create ap key.";
-  GoogleUpdateSettings::UpdateInstallStatus();
+  GoogleUpdateSettings::UpdateInstallStatus(false, installer::FULL_ARCHIVE_TYPE,
+                                            installer::FIRST_INSTALL_SUCCESS);
   EXPECT_STREQ(ReadApKeyValue().c_str(), L"");
   work_item_list->Rollback();
 
@@ -235,9 +265,17 @@ TEST_F(GoogleUpdateSettingsTest, UpdateInstallStatusTest) {
   } else if (key.DeleteValue(google_update::kRegApField) == ERROR_SUCCESS) {
     ap_key_deleted = true;
   }
-  GoogleUpdateSettings::UpdateInstallStatus();
+  // try differential installer
+  GoogleUpdateSettings::UpdateInstallStatus(
+      false, installer::INCREMENTAL_ARCHIVE_TYPE, installer::INSTALL_FAILED);
+  EXPECT_STREQ(ReadApKeyValue().c_str(), L"-full");
+  // try full installer now
+  GoogleUpdateSettings::UpdateInstallStatus(false, installer::FULL_ARCHIVE_TYPE,
+                                            installer::INSTALL_FAILED);
   EXPECT_STREQ(ReadApKeyValue().c_str(), L"");
   // Now cleanup to leave the system in unchanged state.
+  // - Diff installer creates an ap key if it didn't exist, so delete this ap
+  // key
   // - If we created any reg key path for ap, roll it back
   // - Finally restore the original value of ap key.
   if (key.Open(HKEY_CURRENT_USER, reg_key.c_str(),
